
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head profile="http://gmpg.org/xfn/11">





<!-- HERE COMES THE WORK -->


<style type="text/css">
@media print {
    #header, #navigation, #sidebar, .commentlist, #comments, #commentform, .WP-PrintIcon, .wp_rp_wrap, .box, #respond {
        display: none;
    }
    a[href]:after {
        content: " [" attr(href) "]";
    }
    a {
        text-decoration: none;
    }
    p {
        text-align: justify;
    }
}
</style>


<!-- HERE IT ENDS -->






<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<title>PE-формат. Часть 3 &#8212; Импорт</title>

<link rel="apple-touch-icon" href="/apple-touch-icon.png" />
<link rel="stylesheet" href="https://kaimi.io/wp-content/themes/cbone/style.css" type="text/css" media="screen" />
<link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="http://feeds.feedburner.com/kaimi/dev" />
<link rel="pingback" href="https://kaimi.io/xmlrpc.php" />
<link rel="alternate" href="https://kaimi.io" hreflang="ru" />

<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="Misc &raquo; Лента комментариев к &laquo;PE-формат. Часть 3 &#8212; Импорт&raquo;" href="https://kaimi.io/2011/09/pe-format-import/feed/" />
<link rel='stylesheet' id='crayon-css'  href='https://kaimi.io/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-theme-classic-css'  href='https://kaimi.io/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-font-monaco-css'  href='https://kaimi.io/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='wp-polls-css'  href='https://kaimi.io/wp-content/plugins/wp-polls/polls-css.css?ver=2.73.1' type='text/css' media='all' />
<style id='wp-polls-inline-css' type='text/css'>
.wp-polls .pollbar {
    margin: 1px;
    font-size: 2px;
    line-height: 4px;
    height: 4px;
    background-image: url('https://kaimi.io/wp-content/plugins/wp-polls/images/default/pollbg.gif');
    border: 1px solid #c8c8c8;
}

</style>
<link rel='stylesheet' id='wp-pagenavi-css'  href='https://kaimi.io/wp-content/plugins/wp-pagenavi/pagenavi-css.css?ver=2.70' type='text/css' media='all' />
<script type='text/javascript' src='https://kaimi.io/wp-includes/js/jquery/jquery.js?ver=1.12.4'></script>
<script type='text/javascript' src='https://kaimi.io/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/kaimi.io\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"\u041d\u0430\u0436\u043c\u0438\u0442\u0435 %s \u0434\u043b\u044f \u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f, %s \u0434\u043b\u044f \u0432\u0441\u0442\u0430\u0432\u043a\u0438","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type='text/javascript' src='https://kaimi.io/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta'></script>
<link rel='https://api.w.org/' href='https://kaimi.io/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://kaimi.io/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://kaimi.io/wp-includes/wlwmanifest.xml" />
<meta name="generator" content="WordPress 4.6.1" />
<link rel="canonical" href="https://kaimi.io/2011/09/pe-format-import/" />
<link rel='shortlink' href='https://kaimi.io/?p=2446' />
<link rel="alternate" type="application/json+oembed" href="https://kaimi.io/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fkaimi.io%2F2011%2F09%2Fpe-format-import%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://kaimi.io/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fkaimi.io%2F2011%2F09%2Fpe-format-import%2F&#038;format=xml" />

<!-- platinum seo pack 1.3.8 -->
<meta name="robots" content="index,follow,noodp,noydir" />
<meta name="description" content="Импорт - это важнейший элемент любого исполняемого файла. Невозможно найти exe- или" />
<link rel="canonical" href="https://kaimi.io/2011/09/pe-format-import/" />
<!-- /platinum one seo pack -->
<script type="text/javascript">
    window._wp_rp_static_base_url = 'https://wprp.zemanta.com/static/';
    window._wp_rp_wp_ajax_url = "https://kaimi.io/wp-admin/admin-ajax.php";
    window._wp_rp_plugin_version = '3.6.1';
    window._wp_rp_post_id = '2446';
    window._wp_rp_num_rel_posts = '5';
    window._wp_rp_thumbnails = false;
    window._wp_rp_post_title = 'PE-%D1%84%D0%BE%D1%80%D0%BC%D0%B0%D1%82.+%D0%A7%D0%B0%D1%81%D1%82%D1%8C+3+-+%D0%98%D0%BC%D0%BF%D0%BE%D1%80%D1%82';
    window._wp_rp_post_tags = ['bound+import', '%3F%3F%3F%3F%3F%3F%3F%3F%3F%3F%3F+%3F%3F%3F%3F%3F%3F', 'delay+import', '%3F%3F%3F%3F%3F%3F%3F+%3F%3F%3F%3F%3F%3F%3F', 'import', 'pe', 'pe-%3F%3F%3F%3F%3F', '%3F%3F%3F%3F%3F%3F', '%3F%3F%3F%3F%3F%3F%3F%3F%3F%3F+%3F%3F%3F%3F%3F%3F', 'c%2Fc%2B%2B', 'windows', '%3F%3F%3F+%3F%3F%3F%3F%3F%3F%3F%3F', 'em', 'dll', 'pe', 'alt', '3', 'import', 'world'];
    window._wp_rp_promoted_content = false;
</script>
<style type="text/css">
.related_post_title {
}
ul.related_post {
}
ul.related_post li {
}
ul.related_post li a {
}
ul.related_post li img {
}</style>
                <!-- WordPress Popular Posts v3.3.4 -->
                <script type="text/javascript">

                    var sampling_active = 0;
                    var sampling_rate   = 100;
                    var do_request = false;

                    if ( !sampling_active ) {
                        do_request = true;
                    } else {
                        var num = Math.floor(Math.random() * sampling_rate) + 1;
                        do_request = ( 1 === num );
                    }

                    if ( do_request ) {

                        /* Create XMLHttpRequest object and set variables */
                        var xhr = ( window.XMLHttpRequest )
                          ? new XMLHttpRequest()
                          : new ActiveXObject( "Microsoft.XMLHTTP" ),
                        url = 'https://kaimi.io/wp-admin/admin-ajax.php',
                        params = 'action=update_views_ajax&token=85c72fcad6&wpp_id=2446';
                        /* Set request method and target URL */
                        xhr.open( "POST", url, true );
                        /* Set request header */
                        xhr.setRequestHeader( "Content-type", "application/x-www-form-urlencoded" );
                        /* Hook into onreadystatechange */
                        xhr.onreadystatechange = function() {
                            if ( 4 === xhr.readyState && 200 === xhr.status ) {
                                if ( window.console && window.console.log ) {
                                    window.console.log( xhr.responseText );
                                }
                            }
                        };
                        /* Send request */
                        xhr.send( params );

                    }

                </script>
                <!-- End WordPress Popular Posts v3.3.4 -->
                <!-- wp thread comment 1.4.9.4.002 -->
<style type="text/css" media="screen">
.editComment, .editableComment, .textComment{
    display: inline;
}
.comment-childs{
    border: 1px solid #999;
    margin: 5px 2px 2px 4px;
    padding: 4px 2px 2px 4px;
    background-color: white;
}
.chalt{
    background-color: #E2E2E2;
}
#newcomment{
    border:1px dashed #777;width:90%;
}
#newcommentsubmit{
    color:red;
}
.adminreplycomment{
    border:1px dashed #777;
    width:99%;
    margin:4px;
    padding:4px;
}
.mvccls{
    color: #999;
}

</style>
<meta name="blogcatalog" content="9BC9175258" />
<meta name='yandex-verification' content='41749f3e894a31b3' />
</head>

<body>
<div id="shadow_h">
&nbsp;
</div>
<div id="shadow">
<div id="header">
    <div class="content">
        <h1><a href="https://kaimi.io/">Misc</a></h1>
        <div class="description">Misc development</div>
    </div>
    <div id="headsearch">
    <form method="get" id="searchform" action="/">
    <div>
    <input type="text" name="s" id="s" onblur="this.value=(this.value=='') ? 'Поиск' : this.value;" onfocus="this.value=(this.value=='Поиск') ? '' : this.value;" value="Поиск" />
    <input type="submit" id="searchsubmit" value="" />
    </div>
    </form>
    </div>
</div>

<div id="navigation">
<li>
<ul>
<li class="current_page_item"><a href="https://kaimi.io">Главная</a></li>
<li class="page_item page-item-199"><a href="https://kaimi.io/articles/">Статьи</a></li>
<li class="page_item page-item-4406"><a href="https://kaimi.io/software/">Софт</a></li>
<li class="page_item page-item-2103"><a href="https://kaimi.io/forum/">Форум</a></li>
<li class="page_item page-item-16"><a href="https://kaimi.io/about-blog/">О блоге</a></li>
</ul>
</li>
</div>

<div id="container">
<div id="content">
<div style="padding-left:100px;padding-top:5px;">

</div>



<div class="post" id="post-2446">

<h2><a href="https://kaimi.io/2011/09/pe-format-import/print/" title="Print This Post" rel="nofollow"><img class="WP-PrintIcon" src="https://kaimi.io/wp-content/plugins/wp-print/images/print.gif" alt="Print This Post" title="Print This Post" style="border: 0px;" /></a>
PE-формат. Часть 3 &#8212; Импорт</h2>
<p class="time">
Воскресенье, 4. Сентябрь 2011<br />
Раздел: <a href="https://kaimi.io/category/cpp/" rel="category tag">C/C++</a>, <a href="https://kaimi.io/category/windows/" rel="category tag">Windows</a>, <a href="https://kaimi.io/category/%d0%b4%d0%bb%d1%8f-%d0%bd%d0%be%d0%b2%d0%b8%d1%87%d0%ba%d0%be%d0%b2/" rel="category tag">Для новичков</a>, автор: <b><a href="https://kaimi.io/author/dx/" title="Записи dx" rel="author">dx</a></b>
</p>
<div class="entry">
<p>Импорт - это важнейший элемент любого исполняемого файла. Невозможно найти exe- или dll-файл без каких-либо таблиц, имеющих отношение к импорту, разве что у упакованных файлов и у вирусов. Импорт позволяет указать, какие внешние функции и из каких модулей требуются исполняемому файлу для нормальной работы. Например, если мы пишем простейший "Hello, world!", который выводит приветствие в MessageBox'е и завершает выполнение, то ему потребуются как минимум две функции: MessageBoxA (или MessageBoxW) из user32.dll и ExitProcess из kernel32.dll.</p>
<p><img src="http://kaimi.io/wp-content/uploads/2011/09/imports.png" alt="" title="imports" width="477" height="837" class="aligncenter size-full wp-image-2455" /></p>
<p><span id="more-2446"></span></p>
<p>PE-формат имеет несколько способов импорта функций. Самый простой и часто использующийся, но самый медленный - это <em>импорт через таблицу импортируемых функций</em>, когда загрузчик заполняет соответствующую таблице функций таблицу их адресов после загрузки в адресное пространство исполняемого файла всех необходимых библиотек. По сути, это вызов LoadLibrary для каждой требуемой библиотеки и затем вызовы GetProcAddress для каждой импортируемой функции.</p>
<p>Второй механизм - это <em>bound import (привязанный импорт)</em>, который сводится к тому, что на адресное пространство исполняемого файла проецируются библиотеки, а в таблице импорта уже зашиты адреса функций. Это быстрый механизм, но любое изменение динамических библиотек повлечет за собой обязательную перекомпиляцию (перепривязку) исполняемого файла, чтобы все зашитые адреса функций пересчитались. Тем не менее, этот механизм используется в Windows для всех стандартных исполняемых файлов (Калькулятор, Сапер, Блокнот и т.д.), так как стандартные библиотеки Windows меняются крайне редко. Привязанный импорт комбинируется с обычным импортом.</p>
<p>Третий, самый неочевидный механизм, это <em>delay import (отложенный импорт)</em>, основная идея которого состоит в вызове некоторого обработчика, который должен получить адрес требуемой функции и записать его в таблицу адресов импортируемых функций, по мере необходимости.</p>
<p>Для начала рассмотрим классический импорт, так как без него, как правило, не обходится ни один исполняемый файл. С классическим импортом связано несколько таблиц. На корневую таблицу импортируемых функций указывают элементы <strong>IMAGE_DIRECTORY_ENTRY_IMPORT</strong> в <strong>DATA_DIRECTORY</strong> и <strong>IMAGE_DIRECTORY_ENTRY_IAT</strong>, указывающий на <strong>IMPORT_ADDRESS_TABLE</strong> (рассматривается далее), начиная с Windows XP.</p>
<p>Элемент DATA_DIRECTORY <strong>IMAGE_DIRECTORY_ENTRY_IMPORT</strong> указывает на массив расположенных подряд структур <strong>IMAGE_IMPORT_DESCRIPTOR</strong>, причем последний элемент должен быть нулевым (все поля структуры равны 0). Рассмотрим структуру <strong>IMAGE_IMPORT_DESCRIPTOR</strong> подробнее:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

        <div id="crayon-57eb68e0ad137279486951" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" max-width: 587px; margin-top: 12px; margin-bottom: 12px; margin-left: 20px; font-size: 12px !important; line-height: 15px !important;">

            <div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
            <div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Включить/Отключить нумерацию строк"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Включить/Отключить подсветку кода"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Включить/Отключить перенос строк"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Показать код в новом окне"><div class="crayon-button-icon"></div></div><span class="crayon-language">C++</span></div></div>
            <div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
            <div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
typedef struct _IMAGE_IMPORT_DESCRIPTOR {
        union {
                 DWORD Characteristics; // 0 for terminating null import descriptor
                 DWORD OriginalFirstThunk; // RVA to original unbound IAT
         };
         DWORD TimeDateStamp; // 0 if not bound,
         // -1 if bound, and real date\time stamp
         // in IMAGE_DIRECTORY_ENTRY_BOUND_IMPORT (new)
         // O.W. date/time stamp of DLL bound to (old)
         DWORD ForwarderChain; // -1 if no forwarders
         DWORD Name;
         DWORD FirstThunk; // RVA to IAT
} IMAGE_IMPORT_DESCRIPTOR;</textarea></div>
            <div class="crayon-main" style=" max-width: 587px;">
                <table class="crayon-table">
                    <tr class="crayon-row">
                <td class="crayon-nums " data-settings="show">
                    <div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-57eb68e0ad137279486951-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-57eb68e0ad137279486951-2">2</div><div class="crayon-num" data-line="crayon-57eb68e0ad137279486951-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-57eb68e0ad137279486951-4">4</div><div class="crayon-num" data-line="crayon-57eb68e0ad137279486951-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-57eb68e0ad137279486951-6">6</div><div class="crayon-num" data-line="crayon-57eb68e0ad137279486951-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-57eb68e0ad137279486951-8">8</div><div class="crayon-num" data-line="crayon-57eb68e0ad137279486951-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-57eb68e0ad137279486951-10">10</div><div class="crayon-num" data-line="crayon-57eb68e0ad137279486951-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-57eb68e0ad137279486951-12">12</div><div class="crayon-num" data-line="crayon-57eb68e0ad137279486951-13">13</div></div>
                </td>
                        <td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-57eb68e0ad137279486951-1"><span class="crayon-r">typedef</span><span class="crayon-h"> </span><span class="crayon-t">struct</span><span class="crayon-h"> </span><span class="crayon-e">_IMAGE_IMPORT_DESCRIPTOR</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-57eb68e0ad137279486951-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">union</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-57eb68e0ad137279486951-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">DWORD </span><span class="crayon-v">Characteristics</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// 0 for terminating null import descriptor</span></div><div class="crayon-line crayon-striped-line" id="crayon-57eb68e0ad137279486951-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">DWORD </span><span class="crayon-v">OriginalFirstThunk</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// RVA to original unbound IAT</span></div><div class="crayon-line" id="crayon-57eb68e0ad137279486951-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-sy">}</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57eb68e0ad137279486951-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">DWORD </span><span class="crayon-v">TimeDateStamp</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// 0 if not bound,</span></div><div class="crayon-line" id="crayon-57eb68e0ad137279486951-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// -1 if bound, and real date\time stamp</span></div><div class="crayon-line crayon-striped-line" id="crayon-57eb68e0ad137279486951-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// in IMAGE_DIRECTORY_ENTRY_BOUND_IMPORT (new)</span></div><div class="crayon-line" id="crayon-57eb68e0ad137279486951-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// O.W. date/time stamp of DLL bound to (old)</span></div><div class="crayon-line crayon-striped-line" id="crayon-57eb68e0ad137279486951-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">DWORD </span><span class="crayon-v">ForwarderChain</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// -1 if no forwarders</span></div><div class="crayon-line" id="crayon-57eb68e0ad137279486951-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">DWORD </span><span class="crayon-v">Name</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57eb68e0ad137279486951-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">DWORD </span><span class="crayon-v">FirstThunk</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// RVA to IAT</span></div><div class="crayon-line" id="crayon-57eb68e0ad137279486951-13"><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-v">IMAGE_IMPORT_DESCRIPTOR</span><span class="crayon-sy">;</span></div></div></td>
                    </tr>
                </table>
            </div>
        </div>
<!-- [Format Time: 0.0007 seconds] -->
<p></p>
<p>Эта структура справедлива как для PE, так и для PE64. Поле <em>Name</em> - это RVA строки, содержащей имя DLL, из которой будет производиться импорт. Если содержимое поля <em>TimeDateStamp</em> равно нулю, то импорт обрабатывается как обычно, а если -1, то импорт считается привязанным (bound), и к таблице <strong>IMAGE_IMPORT_DESCRIPTOR</strong> загрузчик вернется только в том случае, если привязанный импорт завершится неудачей. Если <em>TimeDateStamp</em> содержит отличное от 0 и 1 значение, то при совпадении этого значения с таймстампом библиотеки она просто проецируется на адресное пространство процесса без дальнейших вызовов GetProcAddress. При этом считается, что все адреса должны быть записаны в таблицу адресов еще на этапе компиляции. Если же таймстампы не совпали, то импорт обрабатывается по полной программе, как обычно.<br />
Поле <em>ForwarderChain</em> системным загрузчиком игнорируется и может содержать что угодно.<br />
Самые важные поля - это <em>OriginalFirstThunk</em> и <em>FirstThunk</em>. Первое указывает на lookup-таблицу, содержащую имена импортируемых функций, а второе - на таблицу адресов импортируемых функций (сюда загрузчик будет писать текущие адреса функций).</p>
<p>На данном этапе я выкладываю свой C++-класс, упрощающий работу с PE-файлами, который я достаточно давно начал писать. Сейчас он еще не завершен, можно наращивать функционал, но для наглядного вывода таблицы импорта исполняемого файла он вполне подойдет. Вот исходный код, печатающий таблицу импорта любого 32-разрядного файла (для 64-раздядного можете сделать сами, минимум отличий):</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

        <div id="crayon-57eb68e0ad148000419433" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" max-width: 587px; margin-top: 12px; margin-bottom: 12px; margin-left: 20px; font-size: 12px !important; line-height: 15px !important;">

            <div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
            <div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Включить/Отключить нумерацию строк"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Включить/Отключить подсветку кода"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Включить/Отключить перенос строк"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Показать код в новом окне"><div class="crayon-button-icon"></div></div><span class="crayon-language">C++</span></div></div>
            <div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
            <div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
//Необходимые стандартные заголовки
#include &lt;iostream&gt;
#include &lt;fstream&gt;
#include &lt;iomanip&gt;
#include &lt;string&gt;
#include &lt;sstream&gt;
//Заголовки, определяющие класс pe32 и pe64, а также исключения
#include "pe3264.h"
#include "pe_exception.h"

int main(int argc, const char* argv[])
{
    if(argc != 2)
    {
        std::cout &lt;&lt; "Usage: sectons.exe pe_file" &lt;&lt; std::endl;
        return 0;
    }

//Открываем PE-файл на чтение
    std::ifstream pefile;
    pefile.open(argv[1], std::ios::in | std::ios::binary);
    if(!pefile.is_open())
    {
        std::cout &lt;&lt; "Can't open file" &lt;&lt; std::endl;
        return 0;
    }

    try
    {
//Создаем объект класса PE32
        pe32 executable(pefile);
//Если у него есть импорты
        if(executable.has_imports())
        {
//Получаем указатель на массив таблиц IMAGE_IMPORT_DESCRIPTOR
            const IMAGE_IMPORT_DESCRIPTOR* import_descriptor_array = reinterpret_cast&lt;const IMAGE_IMPORT_DESCRIPTOR*&gt;(executable.section_data_from_rva(executable.directory_rva(IMAGE_DIRECTORY_ENTRY_IMPORT)));

//И перебираем их до тех пор, пока не достигнем нулевого элемента
            while(import_descriptor_array-&gt;Characteristics)
            {
//Выведем таймстамп и имя библиотеки
                std::cout &lt;&lt; "DLL Name: " &lt;&lt; executable.section_data_from_rva(import_descriptor_array-&gt;Name) &lt;&lt; std::endl;
                std::cout &lt;&lt; "Import TimeDateStamp: " &lt;&lt; import_descriptor_array-&gt;TimeDateStamp &lt;&lt; std::endl;

//Получим указатель на таблицу адресов,
//которую должен заполнить загрузчик
                const DWORD* import_address_table = reinterpret_cast&lt;const DWORD*&gt;(executable.section_data_from_rva(import_descriptor_array-&gt;FirstThunk));

//И указатель на лукап-таблицу, которая содержит
//имена импортируемых функций.
//Стоит обратить внимание на то, что некоторые линкеры
//допускают ошибку и оставляют этот указатель нулевым.
//Это, в принципе, валидный exe-файл, но в случае
//необходимости после загрузки файла  уже не удастся восстановить имена
//импортируемых функций, так как единственная существующая
//в данном случае таблица адресов, являющаяся одновременно и лукап-таблицей,
//будет исковеркана загрузчиком
                const DWORD* import_lookup_table = import_descriptor_array-&gt;OriginalFirstThunk == 0 ? import_address_table : reinterpret_cast&lt;const DWORD*&gt;(executable.section_data_from_rva(import_descriptor_array-&gt;OriginalFirstThunk));

//Для информации
                DWORD address_table = import_descriptor_array-&gt;FirstThunk;

//Переменные для хранения имени импортируемой функции и ее порядкового номера в таблице
//экспортируемых функций DLL (hint)
//Следует обратить внимание на то, что хинт и ординал - это не одно и то же
//Ординал - это некий номер, соответствующий функции, и по этому номеру импорт также может производиться
//Подробнее об этом я напишу, когда доберусь до описания экспорта
                std::string name;
                WORD hint;

                std::cout &lt;&lt; std::endl &lt;&lt; " hint | name/ordinal                |  address" &lt;&lt; std::endl;

//Перебор импортируемых функций
                if(import_lookup_table != 0 &amp;&amp; import_address_table != 0)
                {
                    while(true)
                    {
//Тут стоило бы добавить дополнительные проверки, т.к. указатель для кривого exe
//может оказаться невалидным, но этот пример демонстрационный
//и не стремится быть идеально правильным
                        DWORD address = *import_address_table++;

//Если мы достигли конца списка импортируемых функций, то переходим
//к следующей библиотеке
                        if(!address)
                            break;

                        DWORD lookup = *import_lookup_table++;

//Макрос из WinNT.h, говорит о том, что функция импортируется по ординалу
                        if(IMAGE_SNAP_BY_ORDINAL32(lookup))
                        {
//Если это так, то выведем вместо имени функции ее ординал
                            std::stringstream stream;
                            stream &lt;&lt; "#" &lt;&lt; IMAGE_ORDINAL32(lookup);
                            name = stream.str();
                            hint = 0;
                        }
                        else
                        {
//В противном случае выведем ее имя
                            name = executable.section_data_from_rva(lookup + 2);
                            hint = *reinterpret_cast&lt;const WORD*&gt;(executable.section_data_from_rva(lookup));
                        }

//Выводим информацию об импортируемой функции
                        std::cout &lt;&lt; std::dec &lt;&lt; "[" &lt;&lt; std::setfill('0') &lt;&lt; std::setw(4) &lt;&lt; hint &lt;&lt; "]"
                            &lt;&lt; " " &lt;&lt; std::left &lt;&lt; std::setfill(' ') &lt;&lt; std::setw(30) &lt;&lt; name
                            &lt;&lt; ":0x" &lt;&lt; std::hex &lt;&lt; std::right &lt;&lt; std::setfill('0') &lt;&lt; std::setw(8) &lt;&lt; address_table
                            &lt;&lt; std::endl;

                        address_table += 4;
                    }
                }

                std::cout &lt;&lt; "==========" &lt;&lt; std::endl &lt;&lt; std::endl;

//Переходим к следующей библиотеке
                import_descriptor_array++;
            }
        }
    }
    catch(const pe_exception&amp; e)
    {
//Если вдруг произошла ошибка
        std::cout &lt;&lt; "Exception: " &lt;&lt; e.what() &lt;&lt; std::endl;
    }

    return 0;
}</textarea></div>
            <div class="crayon-main" style=" max-width: 587px;">
                <table class="crayon-table">
                    <tr class="crayon-row">
                <td class="crayon-nums " data-settings="show">
                    <div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-57eb68e0ad148000419433-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-57eb68e0ad148000419433-2">2</div><div class="crayon-num" data-line="crayon-57eb68e0ad148000419433-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-57eb68e0ad148000419433-4">4</div><div class="crayon-num" data-line="crayon-57eb68e0ad148000419433-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-57eb68e0ad148000419433-6">6</div><div class="crayon-num" data-line="crayon-57eb68e0ad148000419433-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-57eb68e0ad148000419433-8">8</div><div class="crayon-num" data-line="crayon-57eb68e0ad148000419433-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-57eb68e0ad148000419433-10">10</div><div class="crayon-num" data-line="crayon-57eb68e0ad148000419433-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-57eb68e0ad148000419433-12">12</div><div class="crayon-num" data-line="crayon-57eb68e0ad148000419433-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-57eb68e0ad148000419433-14">14</div><div class="crayon-num" data-line="crayon-57eb68e0ad148000419433-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-57eb68e0ad148000419433-16">16</div><div class="crayon-num" data-line="crayon-57eb68e0ad148000419433-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-57eb68e0ad148000419433-18">18</div><div class="crayon-num" data-line="crayon-57eb68e0ad148000419433-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-57eb68e0ad148000419433-20">20</div><div class="crayon-num" data-line="crayon-57eb68e0ad148000419433-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-57eb68e0ad148000419433-22">22</div><div class="crayon-num" data-line="crayon-57eb68e0ad148000419433-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-57eb68e0ad148000419433-24">24</div><div class="crayon-num" data-line="crayon-57eb68e0ad148000419433-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-57eb68e0ad148000419433-26">26</div><div class="crayon-num" data-line="crayon-57eb68e0ad148000419433-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-57eb68e0ad148000419433-28">28</div><div class="crayon-num" data-line="crayon-57eb68e0ad148000419433-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-57eb68e0ad148000419433-30">30</div><div class="crayon-num" data-line="crayon-57eb68e0ad148000419433-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-57eb68e0ad148000419433-32">32</div><div class="crayon-num" data-line="crayon-57eb68e0ad148000419433-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-57eb68e0ad148000419433-34">34</div><div class="crayon-num" data-line="crayon-57eb68e0ad148000419433-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-57eb68e0ad148000419433-36">36</div><div class="crayon-num" data-line="crayon-57eb68e0ad148000419433-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-57eb68e0ad148000419433-38">38</div><div class="crayon-num" data-line="crayon-57eb68e0ad148000419433-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-57eb68e0ad148000419433-40">40</div><div class="crayon-num" data-line="crayon-57eb68e0ad148000419433-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-57eb68e0ad148000419433-42">42</div><div class="crayon-num" data-line="crayon-57eb68e0ad148000419433-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-57eb68e0ad148000419433-44">44</div><div class="crayon-num" data-line="crayon-57eb68e0ad148000419433-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-57eb68e0ad148000419433-46">46</div><div class="crayon-num" data-line="crayon-57eb68e0ad148000419433-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-57eb68e0ad148000419433-48">48</div><div class="crayon-num" data-line="crayon-57eb68e0ad148000419433-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-57eb68e0ad148000419433-50">50</div><div class="crayon-num" data-line="crayon-57eb68e0ad148000419433-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-57eb68e0ad148000419433-52">52</div><div class="crayon-num" data-line="crayon-57eb68e0ad148000419433-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-57eb68e0ad148000419433-54">54</div><div class="crayon-num" data-line="crayon-57eb68e0ad148000419433-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-57eb68e0ad148000419433-56">56</div><div class="crayon-num" data-line="crayon-57eb68e0ad148000419433-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-57eb68e0ad148000419433-58">58</div><div class="crayon-num" data-line="crayon-57eb68e0ad148000419433-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-57eb68e0ad148000419433-60">60</div><div class="crayon-num" data-line="crayon-57eb68e0ad148000419433-61">61</div><div class="crayon-num crayon-striped-num" data-line="crayon-57eb68e0ad148000419433-62">62</div><div class="crayon-num" data-line="crayon-57eb68e0ad148000419433-63">63</div><div class="crayon-num crayon-striped-num" data-line="crayon-57eb68e0ad148000419433-64">64</div><div class="crayon-num" data-line="crayon-57eb68e0ad148000419433-65">65</div><div class="crayon-num crayon-striped-num" data-line="crayon-57eb68e0ad148000419433-66">66</div><div class="crayon-num" data-line="crayon-57eb68e0ad148000419433-67">67</div><div class="crayon-num crayon-striped-num" data-line="crayon-57eb68e0ad148000419433-68">68</div><div class="crayon-num" data-line="crayon-57eb68e0ad148000419433-69">69</div><div class="crayon-num crayon-striped-num" data-line="crayon-57eb68e0ad148000419433-70">70</div><div class="crayon-num" data-line="crayon-57eb68e0ad148000419433-71">71</div><div class="crayon-num crayon-striped-num" data-line="crayon-57eb68e0ad148000419433-72">72</div><div class="crayon-num" data-line="crayon-57eb68e0ad148000419433-73">73</div><div class="crayon-num crayon-striped-num" data-line="crayon-57eb68e0ad148000419433-74">74</div><div class="crayon-num" data-line="crayon-57eb68e0ad148000419433-75">75</div><div class="crayon-num crayon-striped-num" data-line="crayon-57eb68e0ad148000419433-76">76</div><div class="crayon-num" data-line="crayon-57eb68e0ad148000419433-77">77</div><div class="crayon-num crayon-striped-num" data-line="crayon-57eb68e0ad148000419433-78">78</div><div class="crayon-num" data-line="crayon-57eb68e0ad148000419433-79">79</div><div class="crayon-num crayon-striped-num" data-line="crayon-57eb68e0ad148000419433-80">80</div><div class="crayon-num" data-line="crayon-57eb68e0ad148000419433-81">81</div><div class="crayon-num crayon-striped-num" data-line="crayon-57eb68e0ad148000419433-82">82</div><div class="crayon-num" data-line="crayon-57eb68e0ad148000419433-83">83</div><div class="crayon-num crayon-striped-num" data-line="crayon-57eb68e0ad148000419433-84">84</div><div class="crayon-num" data-line="crayon-57eb68e0ad148000419433-85">85</div><div class="crayon-num crayon-striped-num" data-line="crayon-57eb68e0ad148000419433-86">86</div><div class="crayon-num" data-line="crayon-57eb68e0ad148000419433-87">87</div><div class="crayon-num crayon-striped-num" data-line="crayon-57eb68e0ad148000419433-88">88</div><div class="crayon-num" data-line="crayon-57eb68e0ad148000419433-89">89</div><div class="crayon-num crayon-striped-num" data-line="crayon-57eb68e0ad148000419433-90">90</div><div class="crayon-num" data-line="crayon-57eb68e0ad148000419433-91">91</div><div class="crayon-num crayon-striped-num" data-line="crayon-57eb68e0ad148000419433-92">92</div><div class="crayon-num" data-line="crayon-57eb68e0ad148000419433-93">93</div><div class="crayon-num crayon-striped-num" data-line="crayon-57eb68e0ad148000419433-94">94</div><div class="crayon-num" data-line="crayon-57eb68e0ad148000419433-95">95</div><div class="crayon-num crayon-striped-num" data-line="crayon-57eb68e0ad148000419433-96">96</div><div class="crayon-num" data-line="crayon-57eb68e0ad148000419433-97">97</div><div class="crayon-num crayon-striped-num" data-line="crayon-57eb68e0ad148000419433-98">98</div><div class="crayon-num" data-line="crayon-57eb68e0ad148000419433-99">99</div><div class="crayon-num crayon-striped-num" data-line="crayon-57eb68e0ad148000419433-100">100</div><div class="crayon-num" data-line="crayon-57eb68e0ad148000419433-101">101</div><div class="crayon-num crayon-striped-num" data-line="crayon-57eb68e0ad148000419433-102">102</div><div class="crayon-num" data-line="crayon-57eb68e0ad148000419433-103">103</div><div class="crayon-num crayon-striped-num" data-line="crayon-57eb68e0ad148000419433-104">104</div><div class="crayon-num" data-line="crayon-57eb68e0ad148000419433-105">105</div><div class="crayon-num crayon-striped-num" data-line="crayon-57eb68e0ad148000419433-106">106</div><div class="crayon-num" data-line="crayon-57eb68e0ad148000419433-107">107</div><div class="crayon-num crayon-striped-num" data-line="crayon-57eb68e0ad148000419433-108">108</div><div class="crayon-num" data-line="crayon-57eb68e0ad148000419433-109">109</div><div class="crayon-num crayon-striped-num" data-line="crayon-57eb68e0ad148000419433-110">110</div><div class="crayon-num" data-line="crayon-57eb68e0ad148000419433-111">111</div><div class="crayon-num crayon-striped-num" data-line="crayon-57eb68e0ad148000419433-112">112</div><div class="crayon-num" data-line="crayon-57eb68e0ad148000419433-113">113</div><div class="crayon-num crayon-striped-num" data-line="crayon-57eb68e0ad148000419433-114">114</div><div class="crayon-num" data-line="crayon-57eb68e0ad148000419433-115">115</div><div class="crayon-num crayon-striped-num" data-line="crayon-57eb68e0ad148000419433-116">116</div><div class="crayon-num" data-line="crayon-57eb68e0ad148000419433-117">117</div><div class="crayon-num crayon-striped-num" data-line="crayon-57eb68e0ad148000419433-118">118</div><div class="crayon-num" data-line="crayon-57eb68e0ad148000419433-119">119</div><div class="crayon-num crayon-striped-num" data-line="crayon-57eb68e0ad148000419433-120">120</div><div class="crayon-num" data-line="crayon-57eb68e0ad148000419433-121">121</div><div class="crayon-num crayon-striped-num" data-line="crayon-57eb68e0ad148000419433-122">122</div><div class="crayon-num" data-line="crayon-57eb68e0ad148000419433-123">123</div><div class="crayon-num crayon-striped-num" data-line="crayon-57eb68e0ad148000419433-124">124</div><div class="crayon-num" data-line="crayon-57eb68e0ad148000419433-125">125</div><div class="crayon-num crayon-striped-num" data-line="crayon-57eb68e0ad148000419433-126">126</div><div class="crayon-num" data-line="crayon-57eb68e0ad148000419433-127">127</div><div class="crayon-num crayon-striped-num" data-line="crayon-57eb68e0ad148000419433-128">128</div><div class="crayon-num" data-line="crayon-57eb68e0ad148000419433-129">129</div><div class="crayon-num crayon-striped-num" data-line="crayon-57eb68e0ad148000419433-130">130</div></div>
                </td>
                        <td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-57eb68e0ad148000419433-1"><span class="crayon-c">//Необходимые стандартные заголовки</span></div><div class="crayon-line crayon-striped-line" id="crayon-57eb68e0ad148000419433-2"><span class="crayon-p">#include &lt;iostream&gt;</span></div><div class="crayon-line" id="crayon-57eb68e0ad148000419433-3"><span class="crayon-p">#include &lt;fstream&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57eb68e0ad148000419433-4"><span class="crayon-p">#include &lt;iomanip&gt;</span></div><div class="crayon-line" id="crayon-57eb68e0ad148000419433-5"><span class="crayon-p">#include &lt;string&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57eb68e0ad148000419433-6"><span class="crayon-p">#include &lt;sstream&gt;</span></div><div class="crayon-line" id="crayon-57eb68e0ad148000419433-7"><span class="crayon-c">//Заголовки, определяющие класс pe32 и pe64, а также исключения</span></div><div class="crayon-line crayon-striped-line" id="crayon-57eb68e0ad148000419433-8"><span class="crayon-p">#include "pe3264.h"</span></div><div class="crayon-line" id="crayon-57eb68e0ad148000419433-9"><span class="crayon-p">#include "pe_exception.h"</span></div><div class="crayon-line crayon-striped-line" id="crayon-57eb68e0ad148000419433-10">&nbsp;</div><div class="crayon-line" id="crayon-57eb68e0ad148000419433-11"><span class="crayon-t">int</span><span class="crayon-h"> </span><span class="crayon-e">main</span><span class="crayon-sy">(</span><span class="crayon-t">int</span><span class="crayon-h"> </span><span class="crayon-v">argc</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-m">const</span><span class="crayon-h"> </span><span class="crayon-t">char</span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">argv</span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-57eb68e0ad148000419433-12"><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-57eb68e0ad148000419433-13"><span class="crayon-h">    </span><span class="crayon-st">if</span><span class="crayon-sy">(</span><span class="crayon-v">argc</span><span class="crayon-h"> </span><span class="crayon-o">!=</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-57eb68e0ad148000419433-14"><span class="crayon-h">    </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-57eb68e0ad148000419433-15"><span class="crayon-h">     </span><span class="crayon-v">std</span><span class="crayon-o">::</span><span class="crayon-r">cout</span><span class="crayon-h"> </span><span class="crayon-o">&lt;&lt;</span><span class="crayon-h"> </span><span class="crayon-s">"Usage: sectons.exe pe_file"</span><span class="crayon-h"> </span><span class="crayon-o">&lt;&lt;</span><span class="crayon-h"> </span><span class="crayon-v">std</span><span class="crayon-o">::</span><span class="crayon-v">endl</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57eb68e0ad148000419433-16"><span class="crayon-h">     </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-57eb68e0ad148000419433-17"><span class="crayon-h"> </span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-57eb68e0ad148000419433-18">&nbsp;</div><div class="crayon-line" id="crayon-57eb68e0ad148000419433-19"><span class="crayon-c">//Открываем PE-файл на чтение</span></div><div class="crayon-line crayon-striped-line" id="crayon-57eb68e0ad148000419433-20"><span class="crayon-h">  </span><span class="crayon-v">std</span><span class="crayon-o">::</span><span class="crayon-r">ifstream</span><span class="crayon-h"> </span><span class="crayon-v">pefile</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-57eb68e0ad148000419433-21"><span class="crayon-h">   </span><span class="crayon-v">pefile</span><span class="crayon-sy">.</span><span class="crayon-e">open</span><span class="crayon-sy">(</span><span class="crayon-v">argv</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">std</span><span class="crayon-o">::</span><span class="crayon-v">ios</span><span class="crayon-o">::</span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-o">|</span><span class="crayon-h"> </span><span class="crayon-v">std</span><span class="crayon-o">::</span><span class="crayon-v">ios</span><span class="crayon-o">::</span><span class="crayon-v">binary</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57eb68e0ad148000419433-22"><span class="crayon-h">    </span><span class="crayon-st">if</span><span class="crayon-sy">(</span><span class="crayon-o">!</span><span class="crayon-v">pefile</span><span class="crayon-sy">.</span><span class="crayon-e">is_open</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-57eb68e0ad148000419433-23"><span class="crayon-h">    </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-57eb68e0ad148000419433-24"><span class="crayon-h">     </span><span class="crayon-v">std</span><span class="crayon-o">::</span><span class="crayon-r">cout</span><span class="crayon-h"> </span><span class="crayon-o">&lt;&lt;</span><span class="crayon-h"> </span><span class="crayon-s">"Can't open file"</span><span class="crayon-h"> </span><span class="crayon-o">&lt;&lt;</span><span class="crayon-h"> </span><span class="crayon-v">std</span><span class="crayon-o">::</span><span class="crayon-v">endl</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-57eb68e0ad148000419433-25"><span class="crayon-h">        </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57eb68e0ad148000419433-26"><span class="crayon-h"> </span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-57eb68e0ad148000419433-27">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-57eb68e0ad148000419433-28"><span class="crayon-h">  </span><span class="crayon-st">try</span></div><div class="crayon-line" id="crayon-57eb68e0ad148000419433-29"><span class="crayon-h">   </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-57eb68e0ad148000419433-30"><span class="crayon-c">//Создаем объект класса PE32</span></div><div class="crayon-line" id="crayon-57eb68e0ad148000419433-31"><span class="crayon-h">      </span><span class="crayon-e">pe32 </span><span class="crayon-e">executable</span><span class="crayon-sy">(</span><span class="crayon-v">pefile</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57eb68e0ad148000419433-32"><span class="crayon-c">//Если у него есть импорты</span></div><div class="crayon-line" id="crayon-57eb68e0ad148000419433-33"><span class="crayon-h">     </span><span class="crayon-st">if</span><span class="crayon-sy">(</span><span class="crayon-v">executable</span><span class="crayon-sy">.</span><span class="crayon-e">has_imports</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-57eb68e0ad148000419433-34"><span class="crayon-h">       </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-57eb68e0ad148000419433-35"><span class="crayon-c">//Получаем указатель на массив таблиц IMAGE_IMPORT_DESCRIPTOR</span></div><div class="crayon-line crayon-striped-line" id="crayon-57eb68e0ad148000419433-36"><span class="crayon-h">         </span><span class="crayon-m">const</span><span class="crayon-h"> </span><span class="crayon-v">IMAGE_IMPORT_DESCRIPTOR</span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">import_descriptor_array</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">reinterpret_cast</span><span class="crayon-o">&lt;</span><span class="crayon-m">const</span><span class="crayon-h"> </span><span class="crayon-v">IMAGE_IMPORT_DESCRIPTOR</span><span class="crayon-o">*</span><span class="crayon-o">&gt;</span><span class="crayon-sy">(</span><span class="crayon-v">executable</span><span class="crayon-sy">.</span><span class="crayon-e">section_data_from_rva</span><span class="crayon-sy">(</span><span class="crayon-v">executable</span><span class="crayon-sy">.</span><span class="crayon-e">directory_rva</span><span class="crayon-sy">(</span><span class="crayon-v">IMAGE_DIRECTORY_ENTRY_IMPORT</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-57eb68e0ad148000419433-37">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-57eb68e0ad148000419433-38"><span class="crayon-c">//И перебираем их до тех пор, пока не достигнем нулевого элемента</span></div><div class="crayon-line" id="crayon-57eb68e0ad148000419433-39"><span class="crayon-h">           </span><span class="crayon-st">while</span><span class="crayon-sy">(</span><span class="crayon-v">import_descriptor_array</span><span class="crayon-o">-&gt;</span><span class="crayon-v">Characteristics</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-57eb68e0ad148000419433-40"><span class="crayon-h">            </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-57eb68e0ad148000419433-41"><span class="crayon-c">//Выведем таймстамп и имя библиотеки</span></div><div class="crayon-line crayon-striped-line" id="crayon-57eb68e0ad148000419433-42"><span class="crayon-h">              </span><span class="crayon-v">std</span><span class="crayon-o">::</span><span class="crayon-r">cout</span><span class="crayon-h"> </span><span class="crayon-o">&lt;&lt;</span><span class="crayon-h"> </span><span class="crayon-s">"DLL Name: "</span><span class="crayon-h"> </span><span class="crayon-o">&lt;&lt;</span><span class="crayon-h"> </span><span class="crayon-v">executable</span><span class="crayon-sy">.</span><span class="crayon-e">section_data_from_rva</span><span class="crayon-sy">(</span><span class="crayon-v">import_descriptor_array</span><span class="crayon-o">-&gt;</span><span class="crayon-v">Name</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&lt;&lt;</span><span class="crayon-h"> </span><span class="crayon-v">std</span><span class="crayon-o">::</span><span class="crayon-v">endl</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-57eb68e0ad148000419433-43"><span class="crayon-h">                </span><span class="crayon-v">std</span><span class="crayon-o">::</span><span class="crayon-r">cout</span><span class="crayon-h"> </span><span class="crayon-o">&lt;&lt;</span><span class="crayon-h"> </span><span class="crayon-s">"Import TimeDateStamp: "</span><span class="crayon-h"> </span><span class="crayon-o">&lt;&lt;</span><span class="crayon-h"> </span><span class="crayon-v">import_descriptor_array</span><span class="crayon-o">-&gt;</span><span class="crayon-v">TimeDateStamp</span><span class="crayon-h"> </span><span class="crayon-o">&lt;&lt;</span><span class="crayon-h"> </span><span class="crayon-v">std</span><span class="crayon-o">::</span><span class="crayon-v">endl</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57eb68e0ad148000419433-44">&nbsp;</div><div class="crayon-line" id="crayon-57eb68e0ad148000419433-45"><span class="crayon-c">//Получим указатель на таблицу адресов,</span></div><div class="crayon-line crayon-striped-line" id="crayon-57eb68e0ad148000419433-46"><span class="crayon-c">//которую должен заполнить загрузчик</span></div><div class="crayon-line" id="crayon-57eb68e0ad148000419433-47"><span class="crayon-h">              </span><span class="crayon-m">const</span><span class="crayon-h"> </span><span class="crayon-v">DWORD</span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">import_address_table</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">reinterpret_cast</span><span class="crayon-o">&lt;</span><span class="crayon-m">const</span><span class="crayon-h"> </span><span class="crayon-v">DWORD</span><span class="crayon-o">*</span><span class="crayon-o">&gt;</span><span class="crayon-sy">(</span><span class="crayon-v">executable</span><span class="crayon-sy">.</span><span class="crayon-e">section_data_from_rva</span><span class="crayon-sy">(</span><span class="crayon-v">import_descriptor_array</span><span class="crayon-o">-&gt;</span><span class="crayon-v">FirstThunk</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57eb68e0ad148000419433-48">&nbsp;</div><div class="crayon-line" id="crayon-57eb68e0ad148000419433-49"><span class="crayon-c">//И указатель на лукап-таблицу, которая содержит</span></div><div class="crayon-line crayon-striped-line" id="crayon-57eb68e0ad148000419433-50"><span class="crayon-c">//имена импортируемых функций.</span></div><div class="crayon-line" id="crayon-57eb68e0ad148000419433-51"><span class="crayon-c">//Стоит обратить внимание на то, что некоторые линкеры</span></div><div class="crayon-line crayon-striped-line" id="crayon-57eb68e0ad148000419433-52"><span class="crayon-c">//допускают ошибку и оставляют этот указатель нулевым.</span></div><div class="crayon-line" id="crayon-57eb68e0ad148000419433-53"><span class="crayon-c">//Это, в принципе, валидный exe-файл, но в случае</span></div><div class="crayon-line crayon-striped-line" id="crayon-57eb68e0ad148000419433-54"><span class="crayon-c">//необходимости после загрузки файла&nbsp;&nbsp;уже не удастся восстановить имена</span></div><div class="crayon-line" id="crayon-57eb68e0ad148000419433-55"><span class="crayon-c">//импортируемых функций, так как единственная существующая</span></div><div class="crayon-line crayon-striped-line" id="crayon-57eb68e0ad148000419433-56"><span class="crayon-c">//в данном случае таблица адресов, являющаяся одновременно и лукап-таблицей,</span></div><div class="crayon-line" id="crayon-57eb68e0ad148000419433-57"><span class="crayon-c">//будет исковеркана загрузчиком</span></div><div class="crayon-line crayon-striped-line" id="crayon-57eb68e0ad148000419433-58"><span class="crayon-h">               </span><span class="crayon-m">const</span><span class="crayon-h"> </span><span class="crayon-v">DWORD</span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">import_lookup_table</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">import_descriptor_array</span><span class="crayon-o">-&gt;</span><span class="crayon-v">OriginalFirstThunk</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-sy">?</span><span class="crayon-h"> </span><span class="crayon-v">import_address_table</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-r">reinterpret_cast</span><span class="crayon-o">&lt;</span><span class="crayon-m">const</span><span class="crayon-h"> </span><span class="crayon-v">DWORD</span><span class="crayon-o">*</span><span class="crayon-o">&gt;</span><span class="crayon-sy">(</span><span class="crayon-v">executable</span><span class="crayon-sy">.</span><span class="crayon-e">section_data_from_rva</span><span class="crayon-sy">(</span><span class="crayon-v">import_descriptor_array</span><span class="crayon-o">-&gt;</span><span class="crayon-v">OriginalFirstThunk</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-57eb68e0ad148000419433-59">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-57eb68e0ad148000419433-60"><span class="crayon-c">//Для информации</span></div><div class="crayon-line" id="crayon-57eb68e0ad148000419433-61"><span class="crayon-h">              </span><span class="crayon-e">DWORD </span><span class="crayon-v">address_table</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">import_descriptor_array</span><span class="crayon-o">-&gt;</span><span class="crayon-v">FirstThunk</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57eb68e0ad148000419433-62">&nbsp;</div><div class="crayon-line" id="crayon-57eb68e0ad148000419433-63"><span class="crayon-c">//Переменные для хранения имени импортируемой функции и ее порядкового номера в таблице</span></div><div class="crayon-line crayon-striped-line" id="crayon-57eb68e0ad148000419433-64"><span class="crayon-c">//экспортируемых функций DLL (hint)</span></div><div class="crayon-line" id="crayon-57eb68e0ad148000419433-65"><span class="crayon-c">//Следует обратить внимание на то, что хинт и ординал - это не одно и то же</span></div><div class="crayon-line crayon-striped-line" id="crayon-57eb68e0ad148000419433-66"><span class="crayon-c">//Ординал - это некий номер, соответствующий функции, и по этому номеру импорт также может производиться</span></div><div class="crayon-line" id="crayon-57eb68e0ad148000419433-67"><span class="crayon-c">//Подробнее об этом я напишу, когда доберусь до описания экспорта</span></div><div class="crayon-line crayon-striped-line" id="crayon-57eb68e0ad148000419433-68"><span class="crayon-h">             </span><span class="crayon-v">std</span><span class="crayon-o">::</span><span class="crayon-t">string</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-57eb68e0ad148000419433-69"><span class="crayon-h">               </span><span class="crayon-t">WORD</span><span class="crayon-h"> </span><span class="crayon-v">hint</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57eb68e0ad148000419433-70">&nbsp;</div><div class="crayon-line" id="crayon-57eb68e0ad148000419433-71"><span class="crayon-h">               </span><span class="crayon-v">std</span><span class="crayon-o">::</span><span class="crayon-r">cout</span><span class="crayon-h"> </span><span class="crayon-o">&lt;&lt;</span><span class="crayon-h"> </span><span class="crayon-v">std</span><span class="crayon-o">::</span><span class="crayon-v">endl</span><span class="crayon-h"> </span><span class="crayon-o">&lt;&lt;</span><span class="crayon-h"> </span><span class="crayon-s">" hint | name/ordinal&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;address"</span><span class="crayon-h"> </span><span class="crayon-o">&lt;&lt;</span><span class="crayon-h"> </span><span class="crayon-v">std</span><span class="crayon-o">::</span><span class="crayon-v">endl</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57eb68e0ad148000419433-72">&nbsp;</div><div class="crayon-line" id="crayon-57eb68e0ad148000419433-73"><span class="crayon-c">//Перебор импортируемых функций</span></div><div class="crayon-line crayon-striped-line" id="crayon-57eb68e0ad148000419433-74"><span class="crayon-h">               </span><span class="crayon-st">if</span><span class="crayon-sy">(</span><span class="crayon-v">import_lookup_table</span><span class="crayon-h"> </span><span class="crayon-o">!=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-v">import_address_table</span><span class="crayon-h"> </span><span class="crayon-o">!=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-57eb68e0ad148000419433-75"><span class="crayon-h">               </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-57eb68e0ad148000419433-76"><span class="crayon-h">                 </span><span class="crayon-st">while</span><span class="crayon-sy">(</span><span class="crayon-t">true</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-57eb68e0ad148000419433-77"><span class="crayon-h">                   </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-57eb68e0ad148000419433-78"><span class="crayon-c">//Тут стоило бы добавить дополнительные проверки, т.к. указатель для кривого exe</span></div><div class="crayon-line" id="crayon-57eb68e0ad148000419433-79"><span class="crayon-c">//может оказаться невалидным, но этот пример демонстрационный</span></div><div class="crayon-line crayon-striped-line" id="crayon-57eb68e0ad148000419433-80"><span class="crayon-c">//и не стремится быть идеально правильным</span></div><div class="crayon-line" id="crayon-57eb68e0ad148000419433-81"><span class="crayon-h">                      </span><span class="crayon-e">DWORD </span><span class="crayon-v">address</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-v">import_address_table</span><span class="crayon-o">++</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57eb68e0ad148000419433-82">&nbsp;</div><div class="crayon-line" id="crayon-57eb68e0ad148000419433-83"><span class="crayon-c">//Если мы достигли конца списка импортируемых функций, то переходим</span></div><div class="crayon-line crayon-striped-line" id="crayon-57eb68e0ad148000419433-84"><span class="crayon-c">//к следующей библиотеке</span></div><div class="crayon-line" id="crayon-57eb68e0ad148000419433-85"><span class="crayon-h">                      </span><span class="crayon-st">if</span><span class="crayon-sy">(</span><span class="crayon-o">!</span><span class="crayon-v">address</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-57eb68e0ad148000419433-86"><span class="crayon-h">                            </span><span class="crayon-st">break</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-57eb68e0ad148000419433-87">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-57eb68e0ad148000419433-88"><span class="crayon-h">                      </span><span class="crayon-e">DWORD </span><span class="crayon-v">lookup</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-v">import_lookup_table</span><span class="crayon-o">++</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-57eb68e0ad148000419433-89">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-57eb68e0ad148000419433-90"><span class="crayon-c">//Макрос из WinNT.h, говорит о том, что функция импортируется по ординалу</span></div><div class="crayon-line" id="crayon-57eb68e0ad148000419433-91"><span class="crayon-h">                     </span><span class="crayon-st">if</span><span class="crayon-sy">(</span><span class="crayon-e">IMAGE_SNAP_BY_ORDINAL32</span><span class="crayon-sy">(</span><span class="crayon-v">lookup</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-57eb68e0ad148000419433-92"><span class="crayon-h">                       </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-57eb68e0ad148000419433-93"><span class="crayon-c">//Если это так, то выведем вместо имени функции ее ординал</span></div><div class="crayon-line crayon-striped-line" id="crayon-57eb68e0ad148000419433-94"><span class="crayon-h">                            </span><span class="crayon-v">std</span><span class="crayon-o">::</span><span class="crayon-e">stringstream </span><span class="crayon-v">stream</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-57eb68e0ad148000419433-95"><span class="crayon-h">                         </span><span class="crayon-v">stream</span><span class="crayon-h"> </span><span class="crayon-o">&lt;&lt;</span><span class="crayon-h"> </span><span class="crayon-s">"#"</span><span class="crayon-h"> </span><span class="crayon-o">&lt;&lt;</span><span class="crayon-h"> </span><span class="crayon-e">IMAGE_ORDINAL32</span><span class="crayon-sy">(</span><span class="crayon-v">lookup</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57eb68e0ad148000419433-96"><span class="crayon-h">                           </span><span class="crayon-v">name</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">stream</span><span class="crayon-sy">.</span><span class="crayon-e">str</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-57eb68e0ad148000419433-97"><span class="crayon-h">                         </span><span class="crayon-v">hint</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57eb68e0ad148000419433-98"><span class="crayon-h">                      </span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-57eb68e0ad148000419433-99"><span class="crayon-h">                     </span><span class="crayon-st">else</span></div><div class="crayon-line crayon-striped-line" id="crayon-57eb68e0ad148000419433-100"><span class="crayon-h">                     </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-57eb68e0ad148000419433-101"><span class="crayon-c">//В противном случае выведем ее имя</span></div><div class="crayon-line crayon-striped-line" id="crayon-57eb68e0ad148000419433-102"><span class="crayon-h">                         </span><span class="crayon-v">name</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">executable</span><span class="crayon-sy">.</span><span class="crayon-e">section_data_from_rva</span><span class="crayon-sy">(</span><span class="crayon-v">lookup</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-57eb68e0ad148000419433-103"><span class="crayon-h">                         </span><span class="crayon-v">hint</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-r">reinterpret_cast</span><span class="crayon-o">&lt;</span><span class="crayon-m">const</span><span class="crayon-h"> </span><span class="crayon-t">WORD</span><span class="crayon-o">*</span><span class="crayon-o">&gt;</span><span class="crayon-sy">(</span><span class="crayon-v">executable</span><span class="crayon-sy">.</span><span class="crayon-e">section_data_from_rva</span><span class="crayon-sy">(</span><span class="crayon-v">lookup</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57eb68e0ad148000419433-104"><span class="crayon-h">                      </span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-57eb68e0ad148000419433-105">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-57eb68e0ad148000419433-106"><span class="crayon-c">//Выводим информацию об импортируемой функции</span></div><div class="crayon-line" id="crayon-57eb68e0ad148000419433-107"><span class="crayon-h">                       </span><span class="crayon-v">std</span><span class="crayon-o">::</span><span class="crayon-r">cout</span><span class="crayon-h"> </span><span class="crayon-o">&lt;&lt;</span><span class="crayon-h"> </span><span class="crayon-v">std</span><span class="crayon-o">::</span><span class="crayon-v">dec</span><span class="crayon-h"> </span><span class="crayon-o">&lt;&lt;</span><span class="crayon-h"> </span><span class="crayon-s">"["</span><span class="crayon-h"> </span><span class="crayon-o">&lt;&lt;</span><span class="crayon-h"> </span><span class="crayon-v">std</span><span class="crayon-o">::</span><span class="crayon-e">setfill</span><span class="crayon-sy">(</span><span class="crayon-s">'0'</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&lt;&lt;</span><span class="crayon-h"> </span><span class="crayon-v">std</span><span class="crayon-o">::</span><span class="crayon-e">setw</span><span class="crayon-sy">(</span><span class="crayon-cn">4</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&lt;&lt;</span><span class="crayon-h"> </span><span class="crayon-v">hint</span><span class="crayon-h"> </span><span class="crayon-o">&lt;&lt;</span><span class="crayon-h"> </span><span class="crayon-s">"]"</span></div><div class="crayon-line crayon-striped-line" id="crayon-57eb68e0ad148000419433-108"><span class="crayon-h">                         </span><span class="crayon-o">&lt;&lt;</span><span class="crayon-h"> </span><span class="crayon-s">" "</span><span class="crayon-h"> </span><span class="crayon-o">&lt;&lt;</span><span class="crayon-h"> </span><span class="crayon-v">std</span><span class="crayon-o">::</span><span class="crayon-v">left</span><span class="crayon-h"> </span><span class="crayon-o">&lt;&lt;</span><span class="crayon-h"> </span><span class="crayon-v">std</span><span class="crayon-o">::</span><span class="crayon-e">setfill</span><span class="crayon-sy">(</span><span class="crayon-s">' '</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&lt;&lt;</span><span class="crayon-h"> </span><span class="crayon-v">std</span><span class="crayon-o">::</span><span class="crayon-e">setw</span><span class="crayon-sy">(</span><span class="crayon-cn">30</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&lt;&lt;</span><span class="crayon-h"> </span><span class="crayon-v">name</span></div><div class="crayon-line" id="crayon-57eb68e0ad148000419433-109"><span class="crayon-h">                          </span><span class="crayon-o">&lt;&lt;</span><span class="crayon-h"> </span><span class="crayon-s">":0x"</span><span class="crayon-h"> </span><span class="crayon-o">&lt;&lt;</span><span class="crayon-h"> </span><span class="crayon-v">std</span><span class="crayon-o">::</span><span class="crayon-v">hex</span><span class="crayon-h"> </span><span class="crayon-o">&lt;&lt;</span><span class="crayon-h"> </span><span class="crayon-v">std</span><span class="crayon-o">::</span><span class="crayon-v">right</span><span class="crayon-h"> </span><span class="crayon-o">&lt;&lt;</span><span class="crayon-h"> </span><span class="crayon-v">std</span><span class="crayon-o">::</span><span class="crayon-e">setfill</span><span class="crayon-sy">(</span><span class="crayon-s">'0'</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&lt;&lt;</span><span class="crayon-h"> </span><span class="crayon-v">std</span><span class="crayon-o">::</span><span class="crayon-e">setw</span><span class="crayon-sy">(</span><span class="crayon-cn">8</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&lt;&lt;</span><span class="crayon-h"> </span><span class="crayon-v">address_table</span></div><div class="crayon-line crayon-striped-line" id="crayon-57eb68e0ad148000419433-110"><span class="crayon-h">                         </span><span class="crayon-o">&lt;&lt;</span><span class="crayon-h"> </span><span class="crayon-v">std</span><span class="crayon-o">::</span><span class="crayon-v">endl</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-57eb68e0ad148000419433-111">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-57eb68e0ad148000419433-112"><span class="crayon-h">                        </span><span class="crayon-v">address_table</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-57eb68e0ad148000419433-113"><span class="crayon-h">                   </span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-57eb68e0ad148000419433-114"><span class="crayon-h">                </span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-57eb68e0ad148000419433-115">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-57eb68e0ad148000419433-116"><span class="crayon-h">                </span><span class="crayon-v">std</span><span class="crayon-o">::</span><span class="crayon-r">cout</span><span class="crayon-h"> </span><span class="crayon-o">&lt;&lt;</span><span class="crayon-h"> </span><span class="crayon-s">"=========="</span><span class="crayon-h"> </span><span class="crayon-o">&lt;&lt;</span><span class="crayon-h"> </span><span class="crayon-v">std</span><span class="crayon-o">::</span><span class="crayon-v">endl</span><span class="crayon-h"> </span><span class="crayon-o">&lt;&lt;</span><span class="crayon-h"> </span><span class="crayon-v">std</span><span class="crayon-o">::</span><span class="crayon-v">endl</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-57eb68e0ad148000419433-117">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-57eb68e0ad148000419433-118"><span class="crayon-c">//Переходим к следующей библиотеке</span></div><div class="crayon-line" id="crayon-57eb68e0ad148000419433-119"><span class="crayon-h">               </span><span class="crayon-v">import_descriptor_array</span><span class="crayon-o">++</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57eb68e0ad148000419433-120"><span class="crayon-h">           </span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-57eb68e0ad148000419433-121"><span class="crayon-h">        </span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-57eb68e0ad148000419433-122"><span class="crayon-h">    </span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-57eb68e0ad148000419433-123"><span class="crayon-h">    </span><span class="crayon-st">catch</span><span class="crayon-sy">(</span><span class="crayon-m">const</span><span class="crayon-h"> </span><span class="crayon-v">pe_exception</span><span class="crayon-o">&amp;</span><span class="crayon-h"> </span><span class="crayon-v">e</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-57eb68e0ad148000419433-124"><span class="crayon-h">   </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-57eb68e0ad148000419433-125"><span class="crayon-c">//Если вдруг произошла ошибка</span></div><div class="crayon-line crayon-striped-line" id="crayon-57eb68e0ad148000419433-126"><span class="crayon-h">       </span><span class="crayon-v">std</span><span class="crayon-o">::</span><span class="crayon-r">cout</span><span class="crayon-h"> </span><span class="crayon-o">&lt;&lt;</span><span class="crayon-h"> </span><span class="crayon-s">"Exception: "</span><span class="crayon-h"> </span><span class="crayon-o">&lt;&lt;</span><span class="crayon-h"> </span><span class="crayon-v">e</span><span class="crayon-sy">.</span><span class="crayon-e">what</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&lt;&lt;</span><span class="crayon-h"> </span><span class="crayon-v">std</span><span class="crayon-o">::</span><span class="crayon-v">endl</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-57eb68e0ad148000419433-127"><span class="crayon-h">  </span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-57eb68e0ad148000419433-128">&nbsp;</div><div class="crayon-line" id="crayon-57eb68e0ad148000419433-129"><span class="crayon-h">    </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57eb68e0ad148000419433-130"><span class="crayon-sy">}</span></div></div></td>
                    </tr>
                </table>
            </div>
        </div>
<!-- [Format Time: 0.0064 seconds] -->
<p></p>
<p>Результат работы программы можно увидеть на скриншоте в начале поста. Исходные коды класса и программы прикреплены в конце статьи. Программы для разбора привязанного и отложенного импорта я приводить не буду, они есть в статье Криса Касперски <a href="http://www.insidepro.com/kk/019/019r.shtml" target="_blank" rel="nofollow">&quot;Путь воина&quot;</a>. Я приведу лишь структуры, связанные с этими типами импорта, и некоторые пояснения касательно их.</p>
<p>С привязанным импортом связана всего одна структура (элемент <strong>IMAGE_DIRECTORY_ENTRY_BOUND_IMPORT</strong> <strong>DATA_DIRECTORY</strong> указывает на массив таких структр, завершающийся нулевым элементом):</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

        <div id="crayon-57eb68e0ad155740789741" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" max-width: 587px; margin-top: 12px; margin-bottom: 12px; margin-left: 20px; font-size: 12px !important; line-height: 15px !important;">

            <div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
            <div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Включить/Отключить нумерацию строк"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Включить/Отключить подсветку кода"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Включить/Отключить перенос строк"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Показать код в новом окне"><div class="crayon-button-icon"></div></div><span class="crayon-language">C++</span></div></div>
            <div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
            <div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
typedef struct _IMAGE_BOUND_IMPORT_DESCRIPTOR {
         DWORD TimeDateStamp;
         WORD OffsetModuleName;
         WORD NumberOfModuleForwarderRefs;
         // Array of zero or more IMAGE_BOUND_FORWARDER_REF follows
} IMAGE_BOUND_IMPORT_DESCRIPTOR, *PIMAGE_BOUND_IMPORT_DESCRIPTOR; </textarea></div>
            <div class="crayon-main" style=" max-width: 587px;">
                <table class="crayon-table">
                    <tr class="crayon-row">
                <td class="crayon-nums " data-settings="show">
                    <div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-57eb68e0ad155740789741-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-57eb68e0ad155740789741-2">2</div><div class="crayon-num" data-line="crayon-57eb68e0ad155740789741-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-57eb68e0ad155740789741-4">4</div><div class="crayon-num" data-line="crayon-57eb68e0ad155740789741-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-57eb68e0ad155740789741-6">6</div></div>
                </td>
                        <td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-57eb68e0ad155740789741-1"><span class="crayon-r">typedef</span><span class="crayon-h"> </span><span class="crayon-t">struct</span><span class="crayon-h"> </span><span class="crayon-e">_IMAGE_BOUND_IMPORT_DESCRIPTOR</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-57eb68e0ad155740789741-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">DWORD </span><span class="crayon-v">TimeDateStamp</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-57eb68e0ad155740789741-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-t">WORD</span><span class="crayon-h"> </span><span class="crayon-v">OffsetModuleName</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57eb68e0ad155740789741-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-t">WORD</span><span class="crayon-h"> </span><span class="crayon-v">NumberOfModuleForwarderRefs</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-57eb68e0ad155740789741-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// Array of zero or more IMAGE_BOUND_FORWARDER_REF follows</span></div><div class="crayon-line crayon-striped-line" id="crayon-57eb68e0ad155740789741-6"><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-v">IMAGE_BOUND_IMPORT_DESCRIPTOR</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-v">PIMAGE_BOUND_IMPORT_DESCRIPTOR</span><span class="crayon-sy">;</span><span class="crayon-h"> </span></div></div></td>
                    </tr>
                </table>
            </div>
        </div>
<!-- [Format Time: 0.0003 seconds] -->
<p></p>
<p>Поле <em>TimeDateStamp</em> содержит временную метку библиотеки для привязанного импорта, и такой импорт будет осуществлен тогда, когда временные метки структуры и библиотеки совпали, либо когда <em>TimeDateStamp</em> = 0. Поле OffsetModuleName - это указатель на имя библиотеки, отсчитываемый от начала массива структур IMAGE_BOUND_IMPORT_DESCRIPTOR. Поле NumberOfModuleForwarderRefs указывает на количество форвардов, назначение этого поля не ясно.<br />
Я сталкивался с exe-файлами, у которых таблицы отложенного импорта находились вне данных секций (т.е. в оверлеях (промежутках между секциями) исполняемого файла), поэтому приходилось дополнительно подгружать их из файла, чтобы считать.</p>
<p>Остается последний механизм импорта - отложенный импорт. Как всегда, элемент <strong>IMAGE_DIRECTORY_ENTRY_DELAY_IMPORT</strong> <strong>DATA_DIRECTORY</strong> указывает на массив нижеописанных структр, завершающийся нулевым элементом):</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

        <div id="crayon-57eb68e0ad166468251436" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" max-width: 587px; margin-top: 12px; margin-bottom: 12px; margin-left: 20px; font-size: 12px !important; line-height: 15px !important;">

            <div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
            <div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Включить/Отключить нумерацию строк"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Включить/Отключить подсветку кода"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Включить/Отключить перенос строк"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Показать код в новом окне"><div class="crayon-button-icon"></div></div><span class="crayon-language">C++</span></div></div>
            <div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
            <div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
typedef struct ImgDelayDescr {
        DWORD grAttrs; // attributes
        LPCSTR szName; // pointer to dll name
        HMODULE* phmod; // address of module handle
        PimgThunkData pIAT; // address of the IAT
        PCImgThunkData pINT; // address of the INT
        PCImgThunkData pBoundIAT; // address of the optional bound IAT
        PCImgThunkData pUnloadIAT; // address of optional copy of original IAT
        DWORD dwTimeStamp; // 0 if not bound,
                           // O.W. date/time stamp of DLL bound to Old BIND
} ImgDelayDescr, * PImgDelayDescr; </textarea></div>
            <div class="crayon-main" style=" max-width: 587px;">
                <table class="crayon-table">
                    <tr class="crayon-row">
                <td class="crayon-nums " data-settings="show">
                    <div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-57eb68e0ad166468251436-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-57eb68e0ad166468251436-2">2</div><div class="crayon-num" data-line="crayon-57eb68e0ad166468251436-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-57eb68e0ad166468251436-4">4</div><div class="crayon-num" data-line="crayon-57eb68e0ad166468251436-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-57eb68e0ad166468251436-6">6</div><div class="crayon-num" data-line="crayon-57eb68e0ad166468251436-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-57eb68e0ad166468251436-8">8</div><div class="crayon-num" data-line="crayon-57eb68e0ad166468251436-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-57eb68e0ad166468251436-10">10</div><div class="crayon-num" data-line="crayon-57eb68e0ad166468251436-11">11</div></div>
                </td>
                        <td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-57eb68e0ad166468251436-1"><span class="crayon-r">typedef</span><span class="crayon-h"> </span><span class="crayon-t">struct</span><span class="crayon-h"> </span><span class="crayon-e">ImgDelayDescr</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-57eb68e0ad166468251436-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">DWORD </span><span class="crayon-v">grAttrs</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// attributes</span></div><div class="crayon-line" id="crayon-57eb68e0ad166468251436-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">LPCSTR </span><span class="crayon-v">szName</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// pointer to dll name</span></div><div class="crayon-line crayon-striped-line" id="crayon-57eb68e0ad166468251436-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">HMODULE</span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">phmod</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// address of module handle</span></div><div class="crayon-line" id="crayon-57eb68e0ad166468251436-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">PimgThunkData </span><span class="crayon-v">pIAT</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// address of the IAT</span></div><div class="crayon-line crayon-striped-line" id="crayon-57eb68e0ad166468251436-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">PCImgThunkData </span><span class="crayon-v">pINT</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// address of the INT</span></div><div class="crayon-line" id="crayon-57eb68e0ad166468251436-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">PCImgThunkData </span><span class="crayon-v">pBoundIAT</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// address of the optional bound IAT</span></div><div class="crayon-line crayon-striped-line" id="crayon-57eb68e0ad166468251436-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">PCImgThunkData </span><span class="crayon-v">pUnloadIAT</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// address of optional copy of original IAT</span></div><div class="crayon-line" id="crayon-57eb68e0ad166468251436-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">DWORD </span><span class="crayon-v">dwTimeStamp</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// 0 if not bound,</span></div><div class="crayon-line crayon-striped-line" id="crayon-57eb68e0ad166468251436-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// O.W. date/time stamp of DLL bound to Old BIND</span></div><div class="crayon-line" id="crayon-57eb68e0ad166468251436-11"><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-v">ImgDelayDescr</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">PImgDelayDescr</span><span class="crayon-sy">;</span><span class="crayon-h"> </span></div></div></td>
                    </tr>
                </table>
            </div>
        </div>
<!-- [Format Time: 0.0008 seconds] -->
<p></p>
<p>Описание структуры взято у Криса Касперски, и тут же я позволю себе процитировать его пояснения касательно это структуры, так как ничего подробнее я не нашел, а самому разбираться не приходилось, так как данный механизм импорта используется крайне редко:</p>
<blockquote><p>Поле grAttrs задает тип адресации, применяющийся в служебных структурах отложенного импорта (0 - VA, 1 - RVA); поле szName содержит RVA/VA-указатель на ASCIIZ-строку с именем загружаемой DLL (тип адреса определяется особенностями реализации конкретного delay helper'а, внедряемого в программу линкером и варьирующегося от реализации к реализации - короче говоря, будьте готовы ко всяким пакостям). В изначально пустое поле phmod загрузчик (все тот же Delay Helper) помещает дескриптор динамически загружаемой DLL.</p>
<p>Поле pIAT содержит указатель на таблицу адресов отложенного импорта, организованную точно также, как и обычная IAT, с той лишь разницей, что все элементы таблицы отложенного импорта ведут к delay load helper'у - специальному динамическому загрузчику, также называемому переходником (thunk), который вызывает LoadLibrary (если только библиотека уже не была загружена), а затем дает GetProcAddress и замещает текущий элемент таблицы отложенного импорта эффективным адресом импортируемой функции, благодаря чему все последующие вызовы данной функции осуществляются напрямую, в обход delay load helper'а.</p>
<p>При выгрузке DLL из памяти, последняя может восстановить таблицу отложенного импорта в исходное состояние, обратившись к ее оригинальной копии, RVA-указатель на которую хранится в поле pUnloadIAT. Если же копии нет, ее указатель будет обращен в ноль.</p>
<p>Поле pINT содержит RVA-указатель на таблицу имен, во всем повторяющую стандартную таблицу имен (см. name Table). То же самое относится и к полю pBoundIAT, хранящим RVA-указатель на таблицу диапазонного импорта. Если таблица диапазонного импорта не пуста и указанная временная метка совпадает с временной меткой соответствующей DLL, системный загрузчик просто проецирует ее на адресное пространство данного процесса и механизм отложенного импорта дезактивируется.</p></blockquote>
<p>В статье Криса Касперски можно также найти простой дампер таблиц отложенного импорта.</p>
<p>Надеюсь, все это вас не слишком испугало :)<br />
На деле, достаточно понять лишь первый механизм, так как он используется чаще всего и без него, как правило, не обходится ни один исполняемый файл.</p>
<p>Обещанные исходные коды класса для работы с PE и программа для разбора таблиц импорта (всё без комментариев): <a href='http://kaimi.io/wp-content/uploads/2011/09/pe_class_imports.zip' target='_blank'>Скачать</a>.</p>

<div class="wp_rp_wrap  wp_rp_plain" id="wp_rp_first"><div class="wp_rp_content"><h3 class="related_post_title">Также рекомендую почитать</h3><ul class="related_post wp_rp"><li data-position="0" data-poid="in-1526" data-post-type="none" ><a href="https://kaimi.io/2010/09/simple-pe-dumper/" class="wp_rp_title">Simple PE Dumper</a><small class="wp_rp_comments_count"> (9)</small><br /></li><li data-position="1" data-poid="in-2880" data-post-type="none" ><a href="https://kaimi.io/2012/03/quest-3-return-to-classics-full-solution/" class="wp_rp_title">Quest 3 &#8212; Return to Classics &#8212; Полное прохождение</a><small class="wp_rp_comments_count"> (25)</small><br /></li><li data-position="2" data-poid="in-3534" data-post-type="none" ><a href="https://kaimi.io/2012/09/pe-packer-step-by-step-5/" class="wp_rp_title">Пишем упаковщик по шагам. Шаг пятый. Ресурсы.</a><small class="wp_rp_comments_count"> (8)</small><br /></li><li data-position="3" data-poid="in-2351" data-post-type="none" ><a href="https://kaimi.io/2011/08/pe-sections-info/" class="wp_rp_title">PE-формат. Часть 2 &#8212; Немного практики: выводим информацию о секциях исполняемого файла</a><small class="wp_rp_comments_count"> (15)</small><br /></li><li data-position="4" data-poid="in-2307" data-post-type="none" ><a href="https://kaimi.io/2011/07/pe-%d1%84%d0%be%d1%80%d0%bc%d0%b0%d1%82-%d0%b1%d0%b0%d0%b7%d0%be%d0%b2%d0%b0%d1%8f-%d0%b8%d0%bd%d1%84%d0%be%d1%80%d0%bc%d0%b0%d1%86%d0%b8%d1%8f/" class="wp_rp_title">PE-формат. Часть 1 &#8212; Базовая информация</a><small class="wp_rp_comments_count"> (17)</small><br /></li></ul></div></div>
<h4><a href="//forum.kaimi.io/viewforum.php?id=5" target="_blank"><img src="https://kaimi.io/wp-content/themes/cbone/go.png" style="border-style:none; vertical-align:middle;" /></a>&nbsp;<a href="//forum.kaimi.io/viewforum.php?id=5" style="text-decoration:none; color:#7A7A7A; vertical-align:middle;" target="_blank">Обсудить на форуме</a></h4>
<br />
<div class="box">
<form action="//feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open('http://feedburner.google.com/fb/a/mailverify?uri=kaimi/dev', 'popupwindow', 'scrollbars=yes,width=550,height=520');return true"><p>Получать обновления на почту: &nbsp;&nbsp;<input type="text" style="width:160px" name="email" value="Ваш e-mail"/>&nbsp;&nbsp;<input type="hidden" value="kaimi/dev" name="uri"/><input type="hidden" name="loc" value="ru_RU"/><input type="submit" value="Подписаться"/></p></form>
</div>

<div id="tags">
<span style="float: left">
Метки: <a href="https://kaimi.io/tag/bound-import/" rel="tag">bound import</a>, <a href="https://kaimi.io/tag/delay-import/" rel="tag">delay import</a>, <a href="https://kaimi.io/tag/import/" rel="tag">import</a>, <a href="https://kaimi.io/tag/pe/" rel="tag">pe</a>, <a href="https://kaimi.io/tag/pe-%d1%84%d0%b0%d0%b9%d0%bb%d1%8b/" rel="tag">PE-файлы</a>, <a href="https://kaimi.io/tag/%d0%b8%d0%bc%d0%bf%d0%be%d1%80%d1%82/" rel="tag">импорт</a>, <a href="https://kaimi.io/tag/%d0%be%d1%82%d0%bb%d0%be%d0%b6%d0%b5%d0%bd%d0%bd%d1%8b%d0%b9-%d0%b8%d0%bc%d0%bf%d0%be%d1%80%d1%82/" rel="tag">отложенный импорт</a>, <a href="https://kaimi.io/tag/%d0%bf%d1%80%d0%b8%d0%b2%d1%8f%d0%b7%d0%b0%d0%bd%d0%bd%d1%8b%d0%b9-%d0%b8%d0%bc%d0%bf%d0%be%d1%80%d1%82/" rel="tag">привязанный импорт</a>, <a href="https://kaimi.io/tag/%d1%82%d0%b0%d0%b1%d0%bb%d0%b8%d1%86%d0%b0-%d0%b8%d0%bc%d0%bf%d0%be%d1%80%d1%82%d0%b0/" rel="tag">таблица импорта</a>.</span>
<div class="yashare-auto-init" data-yashareL10n="ru" ata-yashareType="button" data-yashareQuickServices="vkontakte,facebook,twitter,odnoklassniki,moimir,lj,gplus" style="float: right;"></div>

</div>

</div>

<p class="postmetadata">
Раздел: <a href="https://kaimi.io/category/cpp/" rel="category tag">C/C++</a>, <a href="https://kaimi.io/category/windows/" rel="category tag">Windows</a>, <a href="https://kaimi.io/category/%d0%b4%d0%bb%d1%8f-%d0%bd%d0%be%d0%b2%d0%b8%d1%87%d0%ba%d0%be%d0%b2/" rel="category tag">Для новичков</a>, автор: <b>dx</b>
</p>

</div>

<!-- You can start editing here. -->

    <h3 id="comments">комментариев 17 к &#8220;PE-формат. Часть 3 &#8212; Импорт&#8221;</h3>

    <div class="wp-pagenavi" align="center"><div class="previous_next"></div></div>

    <ol class="commentlist">
    <li class="comment even thread-even depth-1" id="li-comment-11675">
<div id="comment-11675">
<div class="comment-author vcard">
<img alt='' src='https://secure.gravatar.com/avatar/fa0651a69d5639df645fb19e3949d8a4?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/fa0651a69d5639df645fb19e3949d8a4?s=96&amp;d=mm&amp;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' /><br /><cite class="fn">Government</cite> <span class="says">:</span></div>
<div class="comment-meta commentmetadata"><a href="https://kaimi.io/2011/09/pe-format-import/#comment-11675"><small>Сентябрь 4, 2011 в 23:06</small></a></div>
<p>молодцы ребята постоянно черпаю у вас что-то новое</p>
<p class="thdrpy">[<a href="javascript:void(0)" onclick="movecfm(event,11675,1,'Government');">Ответить</a>]</p><!--
<div class="reply">
<a rel='nofollow' class='comment-reply-link' href='https://kaimi.io/2011/09/pe-format-import/?replytocom=11675#respond' onclick='return addComment.moveForm( "comment-11675", "11675", "respond", "2446" )' aria-label='Комментарий к записи Government'>Ответить</a></div>
-->

</div>
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-11696">
<div id="comment-11696">
<div class="comment-author vcard">
<img alt='' src='https://secure.gravatar.com/avatar/3731f606afa8dccc9123bdd4062c4af1?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/3731f606afa8dccc9123bdd4062c4af1?s=96&amp;d=mm&amp;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' /><br /><cite class="fn">arti</cite> <span class="says">:</span></div>
<div class="comment-meta commentmetadata"><a href="https://kaimi.io/2011/09/pe-format-import/#comment-11696"><small>Сентябрь 14, 2011 в 06:47</small></a></div>
<p>интересная статейка ))<br />
есть один вопрос не в тему - какой компонент использовали для ведения логов в программе No Ads ?</p>
<p class="thdrpy">[<a href="javascript:void(0)" onclick="movecfm(event,11696,1,'arti');">Ответить</a>]</p><div class="comment-childs chalt" id="comment-11697"><img alt='' src='https://secure.gravatar.com/avatar/ec3a94a252a6004c43717bc187b9d852?s=32&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/ec3a94a252a6004c43717bc187b9d852?s=64&amp;d=mm&amp;r=g 2x' class='avatar avatar-32 photo' height='32' width='32' /><p><cite><a href='http://kaimi.io' rel='external nofollow' class='url'>Kaimi</a></cite>:<br /><small class="commentmetadata">Сентябрь 14th, 2011 at 14:01</small></p><p>Если речь о поле внизу формы, то это простой textbox</p>
<p class="thdrpy">[<a href="javascript:void(0)" onclick="movecfm(event,11697,2,'Kaimi');">Ответить</a>]</p><div class="comment-childs" id="comment-11698"><img alt='' src='https://secure.gravatar.com/avatar/3731f606afa8dccc9123bdd4062c4af1?s=32&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/3731f606afa8dccc9123bdd4062c4af1?s=64&amp;d=mm&amp;r=g 2x' class='avatar avatar-32 photo' height='32' width='32' /><p><cite>arti</cite>:<br /><small class="commentmetadata">Сентябрь 14th, 2011 at 21:44</small></p><p>Извиняюсь что опять не в тему. Как растянуть текстбокс на пару строк я понял, а как сделать вывод по строкам ? Ну например как в том же No Ads пишется по строчке что программа сделала. У меня только заменяет первую строку. Делал так:<br />
this-&gt;tb_logs-&gt;Text = "Command " + this-&gt;tb_command-&gt;Text+ " | " + this-&gt;tb_1param-&gt;Text+ " | "+ this-&gt;tb_2param-&gt;Text + " sent on " + this-&gt;tb_host-&gt;Text + ".\n";</p>
<p class="thdrpy">[<a href="javascript:void(0)" onclick="movecfm(event,11698,3,'arti');">Ответить</a>]</p><div class="comment-childs chalt" id="comment-11700"><img alt='' src='https://secure.gravatar.com/avatar/ec3a94a252a6004c43717bc187b9d852?s=32&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/ec3a94a252a6004c43717bc187b9d852?s=64&amp;d=mm&amp;r=g 2x' class='avatar avatar-32 photo' height='32' width='32' /><p><cite><a href='http://kaimi.io' rel='external nofollow' class='url'>Kaimi</a></cite>:<br /><small class="commentmetadata">Сентябрь 14th, 2011 at 22:04</small></p><p>logBox.AppendText(text + "\r\n");</p>
</div></div></div><!--
<div class="reply">
<a rel='nofollow' class='comment-reply-link' href='https://kaimi.io/2011/09/pe-format-import/?replytocom=11696#respond' onclick='return addComment.moveForm( "comment-11696", "11696", "respond", "2446" )' aria-label='Комментарий к записи arti'>Ответить</a></div>
-->

</div>
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-11701">
<div id="comment-11701">
<div class="comment-author vcard">
<img alt='' src='https://secure.gravatar.com/avatar/3731f606afa8dccc9123bdd4062c4af1?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/3731f606afa8dccc9123bdd4062c4af1?s=96&amp;d=mm&amp;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' /><br /><cite class="fn">arti</cite> <span class="says">:</span></div>
<div class="comment-meta commentmetadata"><a href="https://kaimi.io/2011/09/pe-format-import/#comment-11701"><small>Сентябрь 15, 2011 в 00:19</small></a></div>
<p>Строки не понял = порылся в сорцах = заюзал вот это<br />
this-&gt;tb_logs-&gt;AppendText(String::Concat(text, "\r\n")); - помогло.<br />
Спасибо за помощь !</p>
<p class="thdrpy">[<a href="javascript:void(0)" onclick="movecfm(event,11701,1,'arti');">Ответить</a>]</p><!--
<div class="reply">
<a rel='nofollow' class='comment-reply-link' href='https://kaimi.io/2011/09/pe-format-import/?replytocom=11701#respond' onclick='return addComment.moveForm( "comment-11701", "11701", "respond", "2446" )' aria-label='Комментарий к записи arti'>Ответить</a></div>
-->

</div>
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-12028">
<div id="comment-12028">
<div class="comment-author vcard">
<img alt='' src='https://secure.gravatar.com/avatar/33fd8b0f70bc09555b992d8ac8db4459?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/33fd8b0f70bc09555b992d8ac8db4459?s=96&amp;d=mm&amp;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' /><br /><cite class="fn">censored</cite> <span class="says">:</span></div>
<div class="comment-meta commentmetadata"><a href="https://kaimi.io/2011/09/pe-format-import/#comment-12028"><small>Декабрь 26, 2011 в 22:32</small></a></div>
<p>у меня проблемка почему то получаю только системные dll, importsStartRVA = GetImgDirEntryRVA(pNTHeader,IMAGE_DIRECTORY_ENTRY_IMPORT);<br />
в чем может быть проблема?</p>
<p class="thdrpy">[<a href="javascript:void(0)" onclick="movecfm(event,12028,1,'censored');">Ответить</a>]</p><div class="comment-childs chalt" id="comment-12029"><img alt='' src='https://secure.gravatar.com/avatar/68263912c39b44daeafc5bfa3ecc9426?s=32&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/68263912c39b44daeafc5bfa3ecc9426?s=64&amp;d=mm&amp;r=g 2x' class='avatar avatar-32 photo' height='32' width='32' /><p><cite>dx</cite>:<br /><small class="commentmetadata">Декабрь 26th, 2011 at 22:57</small></p><p>Я не понял вопрос. В чем конкретно проблема, и что такое GetImgDirEntryRVA? Судя по гуглу, оно позволяет лишь определить RVA директории импорта.</p>
<p class="thdrpy">[<a href="javascript:void(0)" onclick="movecfm(event,12029,2,'dx');">Ответить</a>]</p></div><!--
<div class="reply">
<a rel='nofollow' class='comment-reply-link' href='https://kaimi.io/2011/09/pe-format-import/?replytocom=12028#respond' onclick='return addComment.moveForm( "comment-12028", "12028", "respond", "2446" )' aria-label='Комментарий к записи censored'>Ответить</a></div>
-->

</div>
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-13203">
<div id="comment-13203">
<div class="comment-author vcard">
<img alt='' src='https://secure.gravatar.com/avatar/a13f87af1031964954e7df7361e15d4b?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a13f87af1031964954e7df7361e15d4b?s=96&amp;d=mm&amp;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' /><br /><cite class="fn">Викинг</cite> <span class="says">:</span></div>
<div class="comment-meta commentmetadata"><a href="https://kaimi.io/2011/09/pe-format-import/#comment-13203"><small>Июнь 28, 2012 в 13:33</small></a></div>
<p>"Например, если мы пишем простейший "Hello, world!", который выводит приветствие в MessageBox'е и завершает выполнение, то ему потребуются как минимум две функции: MessageBoxA (или MessageBoxW) из user32.dll и ExitProcess из kernel32.dll."<br />
Поправка: на самом деле и ExitProcess не нужен, достаточно MessageBoxA/MessageBoxW.</p>
<p>invoke MessageBoxA, 0, chr$("Caption"), chr$("Text"), 0<br />
ret</p>
<p class="thdrpy">[<a href="javascript:void(0)" onclick="movecfm(event,13203,1,'Викинг');">Ответить</a>]</p><!--
<div class="reply">
<a rel='nofollow' class='comment-reply-link' href='https://kaimi.io/2011/09/pe-format-import/?replytocom=13203#respond' onclick='return addComment.moveForm( "comment-13203", "13203", "respond", "2446" )' aria-label='Комментарий к записи Викинг'>Ответить</a></div>
-->

</div>
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-13751">
<div id="comment-13751">
<div class="comment-author vcard">
<img alt='' src='https://secure.gravatar.com/avatar/bfb5aff87942f4f5c866d031054b9c67?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/bfb5aff87942f4f5c866d031054b9c67?s=96&amp;d=mm&amp;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' /><br /><cite class="fn">alex</cite> <span class="says">:</span></div>
<div class="comment-meta commentmetadata"><a href="https://kaimi.io/2011/09/pe-format-import/#comment-13751"><small>Сентябрь 26, 2012 в 17:41</small></a></div>
<p>dx, отличная работа, безусловно наиполезнейшая либа. Хотелось бы узнать способна ли она собирать ехе с нуля как болванку... т.е. собираем дос хидер, нт хидер, опшионал хидер, добавляем секции там (код, дата, рсрц етц), настраиваем точку входа на секцию кода, имэджбейс, сайзофимэдж етц. и на выходе получаем готовый пе файл-пустышку. Я извеняюсь если это уже реализованно у вас, я пока не смотрел вашей библиотеки, прошолся бегло взглядом единственное по папке с сэмплами....</p>
<p class="thdrpy">[<a href="javascript:void(0)" onclick="movecfm(event,13751,1,'alex');">Ответить</a>]</p><div class="comment-childs chalt" id="comment-13752"><img alt='' src='https://secure.gravatar.com/avatar/68263912c39b44daeafc5bfa3ecc9426?s=32&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/68263912c39b44daeafc5bfa3ecc9426?s=64&amp;d=mm&amp;r=g 2x' class='avatar avatar-32 photo' height='32' width='32' /><p><cite>dx</cite>:<br /><small class="commentmetadata">Сентябрь 26th, 2012 at 18:39</small></p><p>С нуля не собирает, хотя думал над этим, да руки не дошли пока. Пока что можно взять готовый PE-файл, удалить у него все секции и работать исходя из этого, так как все поля, флаги редактировать можно.</p>
<p class="thdrpy">[<a href="javascript:void(0)" onclick="movecfm(event,13752,2,'dx');">Ответить</a>]</p><div class="comment-childs" id="comment-13753"><img alt='' src='https://secure.gravatar.com/avatar/bfb5aff87942f4f5c866d031054b9c67?s=32&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/bfb5aff87942f4f5c866d031054b9c67?s=64&amp;d=mm&amp;r=g 2x' class='avatar avatar-32 photo' height='32' width='32' /><p><cite>alex</cite>:<br /><small class="commentmetadata">Сентябрь 26th, 2012 at 19:05</small></p><p>можно взять болванку например пустого файла на масме и уже на базе его строить свой ехе...<br />
ну хотя мне видится, что в полноценной библиотеке болванка ехе обязательно должна быть:) если появится время, можем списаться, готов посодействовать идеями, и возможно кодом.</p>
<p class="thdrpy">[<a href="javascript:void(0)" onclick="movecfm(event,13753,3,'alex');">Ответить</a>]</p><div class="comment-childs chalt" id="comment-13754"><img alt='' src='https://secure.gravatar.com/avatar/68263912c39b44daeafc5bfa3ecc9426?s=32&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/68263912c39b44daeafc5bfa3ecc9426?s=64&amp;d=mm&amp;r=g 2x' class='avatar avatar-32 photo' height='32' width='32' /><p><cite>dx</cite>:<br /><small class="commentmetadata">Сентябрь 26th, 2012 at 19:38</small></p><p>Да я думаю, что доработаю этот функционал. Я библиотеку еще не забросил и с момента релиза очень много багов всяких поправил там, функционал нарастил немного, и пока продолжаю :) В хедере pe_base.h даже список TODO заготовил, хотя его пока тоже не начинал делать.</p>
</div></div></div><!--
<div class="reply">
<a rel='nofollow' class='comment-reply-link' href='https://kaimi.io/2011/09/pe-format-import/?replytocom=13751#respond' onclick='return addComment.moveForm( "comment-13751", "13751", "respond", "2446" )' aria-label='Комментарий к записи alex'>Ответить</a></div>
-->

</div>
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-13756">
<div id="comment-13756">
<div class="comment-author vcard">
<img alt='' src='https://secure.gravatar.com/avatar/bfb5aff87942f4f5c866d031054b9c67?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/bfb5aff87942f4f5c866d031054b9c67?s=96&amp;d=mm&amp;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' /><br /><cite class="fn">alex</cite> <span class="says">:</span></div>
<div class="comment-meta commentmetadata"><a href="https://kaimi.io/2011/09/pe-format-import/#comment-13756"><small>Сентябрь 26, 2012 в 20:43</small></a></div>
<p>&gt;Я библиотеку еще не забросил и с момента релиза очень много багов всяких поправил там<br />
супер. очень радует ваше творчество. видимо вами движет очень сильная мотивация.</p>
<p>p.s.<br />
мне кажется ваш туду лист еще будет пополняться;) btw релоки с несколькими элементами тоже не видел ни разу.</p>
<p class="thdrpy">[<a href="javascript:void(0)" onclick="movecfm(event,13756,1,'alex');">Ответить</a>]</p><!--
<div class="reply">
<a rel='nofollow' class='comment-reply-link' href='https://kaimi.io/2011/09/pe-format-import/?replytocom=13756#respond' onclick='return addComment.moveForm( "comment-13756", "13756", "respond", "2446" )' aria-label='Комментарий к записи alex'>Ответить</a></div>
-->

</div>
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-14259">
<div id="comment-14259">
<div class="comment-author vcard">
<img alt='' src='https://secure.gravatar.com/avatar/3f029026f0e2a58c0f5213d7f3cd08e8?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/3f029026f0e2a58c0f5213d7f3cd08e8?s=96&amp;d=mm&amp;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' /><br /><cite class="fn">Avazart</cite> <span class="says">:</span></div>
<div class="comment-meta commentmetadata"><a href="https://kaimi.io/2011/09/pe-format-import/#comment-14259"><small>Март 4, 2013 в 00:01</small></a></div>
<p>//Заголовки, определяющие класс pe32 и pe64, а также исключения<br />
#include "pe3264.h"<br />
#include "pe_exception.h"</p>
<p>И где это должен взять читающий ?</p>
<p class="thdrpy">[<a href="javascript:void(0)" onclick="movecfm(event,14259,1,'Avazart');">Ответить</a>]</p><div class="comment-childs chalt" id="comment-14260"><img alt='' src='https://secure.gravatar.com/avatar/68263912c39b44daeafc5bfa3ecc9426?s=32&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/68263912c39b44daeafc5bfa3ecc9426?s=64&amp;d=mm&amp;r=g 2x' class='avatar avatar-32 photo' height='32' width='32' /><p><cite>dx</cite>:<br /><small class="commentmetadata">Март 4th, 2013 at 00:10</small></p><p>Очевидно, скачать по ссылке в конце поста.</p>
<p class="thdrpy">[<a href="javascript:void(0)" onclick="movecfm(event,14260,2,'dx');">Ответить</a>]</p></div><!--
<div class="reply">
<a rel='nofollow' class='comment-reply-link' href='https://kaimi.io/2011/09/pe-format-import/?replytocom=14259#respond' onclick='return addComment.moveForm( "comment-14259", "14259", "respond", "2446" )' aria-label='Комментарий к записи Avazart'>Ответить</a></div>
-->

</div>
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-14261">
<div id="comment-14261">
<div class="comment-author vcard">
<img alt='' src='https://secure.gravatar.com/avatar/3f029026f0e2a58c0f5213d7f3cd08e8?s=48&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/3f029026f0e2a58c0f5213d7f3cd08e8?s=96&amp;d=mm&amp;r=g 2x' class='avatar avatar-48 photo' height='48' width='48' /><br /><cite class="fn">Avazart</cite> <span class="says">:</span></div>
<div class="comment-meta commentmetadata"><a href="https://kaimi.io/2011/09/pe-format-import/#comment-14261"><small>Март 4, 2013 в 00:22</small></a></div>
<p>Спасибо, не обратил внимание на неё.</p>
<p class="thdrpy">[<a href="javascript:void(0)" onclick="movecfm(event,14261,1,'Avazart');">Ответить</a>]</p><!--
<div class="reply">
<a rel='nofollow' class='comment-reply-link' href='https://kaimi.io/2011/09/pe-format-import/?replytocom=14261#respond' onclick='return addComment.moveForm( "comment-14261", "14261", "respond", "2446" )' aria-label='Комментарий к записи Avazart'>Ответить</a></div>
-->

</div>
</li><!-- #comment-## -->
    </ol>
    <br />
    <div class="wp-pagenavi" align="center"><div class="previous_next"></div></div>




<h3 id="respond">Оставьте ваш комментарий</h3>


<form action="https://kaimi.io/wp-comments-post.php" method="post" id="commentform">


<p><input type="text" name="author" id="author" value="" size="22" tabindex="1" />
<label for="author"><small>Имя (обязательно)</small></label></p>

<p><input type="text" name="email" id="email" value="" size="22" tabindex="2" />
<label for="email"><small>E-mail (не будет опубликован) (обязательно)</small></label></p>

<p><input type="text" name="url" id="url" value="" size="22" tabindex="3" />
<label for="url"><small>Сайт</small></label></p>


<!--<p><small><strong>XHTML:</strong> You can use these tags: &lt;a href=&quot;&quot; title=&quot;&quot;&gt; &lt;abbr title=&quot;&quot;&gt; &lt;acronym title=&quot;&quot;&gt; &lt;b&gt; &lt;blockquote cite=&quot;&quot;&gt; &lt;cite&gt; &lt;code class=&quot;&quot; title=&quot;&quot; data-url=&quot;&quot;&gt; &lt;del datetime=&quot;&quot;&gt; &lt;em&gt; &lt;i&gt; &lt;q cite=&quot;&quot;&gt; &lt;s&gt; &lt;strike&gt; &lt;strong&gt; &lt;pre class=&quot;&quot; title=&quot;&quot; data-url=&quot;&quot;&gt; &lt;span class=&quot;&quot; title=&quot;&quot; data-url=&quot;&quot;&gt; </small></p>-->

<p><textarea name="9d261-comment" id="comment" cols="100%" rows="10" tabindex="4"></textarea><textarea name="comment" style="display:none" rows="1" cols="1"></textarea></p>

<p><input name="submit" type="submit" id="submit" tabindex="5" value="Сказать" />
<input type="hidden" name="comment_post_ID" value="2446" />
</p>


<script type="text/javascript">/*<![CDATA[*/
var $j = jQuery.noConflict();
$j(document).ready(function() {
    $j('a.jqcl').each(function() {
        var link = $j(this).attr('title');
        $j(this).attr('href', 'http://'+link).attr('title', 'http://'+link);
    });
})
/*]]>*/</script>
<p><input type="hidden" id="comment_reply_ID" name="comment_reply_ID" value="0" /><input type="hidden" id="comment_reply_dp" name="comment_reply_dp" value="0" /></p><div id="cancel_reply" style="display:none;"><a href="javascript:void(0)" onclick="movecfm(null,0,1,null);" style="color:red;">Отменить написание комментария</a></div><p><input type="checkbox" name="comment_mail_notify" id="comment_mail_notify" value="comment_mail_notify" style="width: auto;" /><label for="comment_mail_notify" style="display: inline;">Notify me of follow-up comments via e-mail</label></p><script type="text/javascript">
/* <![CDATA[ */
var commentformid = "commentform";
var USERINFO = false;
var atreply = "none";
/* ]]> */
</script>

</form>



<div class="previous_next">
    </div>

</div>
<div id="sidebar">
     <br />

    <ul>
    <li id="text-3" class="widget widget_text"><h2 class="widgettitle">Предупреждение</h2>
            <div class="textwidget"><p style="text-align:justify; font-family: Arial Sans, sans-serif; margin: 0px">Все материалы сайта предоставлены исключительно в ознакомительных и обучающих целях. Ответственность за использование их в корыстных целях полностью ложится на ваши плечи.</p></div>
        </li>

<!-- WordPress Popular Posts Plugin v3.3.4 [W] [daily] [views] [custom] -->
<li id="wpp-3" class="widget popular-posts">
<h2 class="widgettitle">Популярные публикации</h2>
                <script type="text/javascript">
                    /* jQuery is available, so proceed */
                    if ( window.jQuery ) {

                        jQuery(document).ready(function($){
                            $.get('https://kaimi.io/wp-admin/admin-ajax.php', {
                                action: 'wpp_get_popular',
                                id: '3'
                            }, function(data){
                                $('#wpp-3').append(data);
                            });
                        });

                    } /* jQuery is not defined */
                    else {
                        if ( window.console && window.console.log ) {
                            window.console.log('WordPress Popular Posts: jQuery is not defined!');
                        }
                    }
                </script>
                </li>

<!-- End WordPress Popular Posts Plugin v3.3.4 -->
<li id="categories-3" class="widget widget_categories"><h2 class="widgettitle">Категории</h2>
        <ul>
    <li class="cat-item cat-item-222"><a href="https://kaimi.io/category/net/" >.NET</a>
</li>
    <li class="cat-item cat-item-88"><a href="https://kaimi.io/category/%d0%b4%d0%b5%d0%bd%d1%8c%d0%b3%d0%b8/" >$$$</a>
</li>
    <li class="cat-item cat-item-48"><a href="https://kaimi.io/category/assembler/" title="Assembler x86">Assembler</a>
</li>
    <li class="cat-item cat-item-173"><a href="https://kaimi.io/category/cpp/" >C/C++</a>
</li>
    <li class="cat-item cat-item-108"><a href="https://kaimi.io/category/c-sharp/" >C#</a>
</li>
    <li class="cat-item cat-item-448"><a href="https://kaimi.io/category/code-review-2/" >Code Review</a>
</li>
    <li class="cat-item cat-item-274"><a href="https://kaimi.io/category/html-js/" >HTML/JS</a>
</li>
    <li class="cat-item cat-item-491"><a href="https://kaimi.io/category/java/" >Java</a>
</li>
    <li class="cat-item cat-item-143"><a href="https://kaimi.io/category/linux/" >Linux</a>
</li>
    <li class="cat-item cat-item-152"><a href="https://kaimi.io/category/lua/" >Lua</a>
</li>
    <li class="cat-item cat-item-4"><a href="https://kaimi.io/category/perl/" title="perl scripts">Perl</a>
</li>
    <li class="cat-item cat-item-24"><a href="https://kaimi.io/category/php/" >PHP</a>
</li>
    <li class="cat-item cat-item-579"><a href="https://kaimi.io/category/python/" >Python</a>
</li>
    <li class="cat-item cat-item-580"><a href="https://kaimi.io/category/reversing/" >Reversing</a>
</li>
    <li class="cat-item cat-item-142"><a href="https://kaimi.io/category/windows/" >Windows</a>
</li>
    <li class="cat-item cat-item-1"><a href="https://kaimi.io/category/uncategorized/" >Без категории</a>
</li>
    <li class="cat-item cat-item-453"><a href="https://kaimi.io/category/b/" >Бред</a>
</li>
    <li class="cat-item cat-item-204"><a href="https://kaimi.io/category/%d0%b4%d0%bb%d1%8f-%d0%bd%d0%be%d0%b2%d0%b8%d1%87%d0%ba%d0%be%d0%b2/" >Для новичков</a>
</li>
    <li class="cat-item cat-item-100"><a href="https://kaimi.io/category/life/" >Жизнь</a>
</li>
    <li class="cat-item cat-item-261"><a href="https://kaimi.io/category/snippets/" >Сниппеты</a>
</li>
    <li class="cat-item cat-item-269"><a href="https://kaimi.io/category/soft/" >Софт</a>
</li>
    <li class="cat-item cat-item-17"><a href="https://kaimi.io/category/%d1%81%d0%be%d1%86%d0%b8%d0%b0%d0%bb%d1%8c%d0%bd%d1%8b%d0%b5-%d1%81%d0%b5%d1%82%d0%b8/" >Социальные сети</a>
</li>
    <li class="cat-item cat-item-166"><a href="https://kaimi.io/category/%d1%8d%d1%82%d0%be-%d0%b8%d0%bd%d1%82%d0%b5%d1%80%d0%b5%d1%81%d0%bd%d0%be/" >Это интересно</a>
</li>
    <li class="cat-item cat-item-242"><a href="https://kaimi.io/category/%d1%8e%d0%bc%d0%be%d1%80/" >Юмор</a>
</li>
        </ul>
</li>
<li id="tag_cloud-3" class="widget widget_tag_cloud"><h2 class="widgettitle">Метки</h2>
<div class="tagcloud"><a href='https://kaimi.io/tag/assembler/' class='tag-link-565 tag-link-position-1' title='17 записей' style='font-size: 18.38202247191pt;'>Assembler</a>
<a href='https://kaimi.io/tag/bruteforce/' class='tag-link-22 tag-link-position-2' title='3 записи' style='font-size: 8pt;'>bruteforce</a>
<a href='https://kaimi.io/tag/c/' class='tag-link-61 tag-link-position-3' title='24 записи' style='font-size: 20.584269662921pt;'>c++</a>
<a href='https://kaimi.io/tag/cmd/' class='tag-link-139 tag-link-position-4' title='3 записи' style='font-size: 8pt;'>cmd</a>
<a href='https://kaimi.io/tag/crypto-api/' class='tag-link-69 tag-link-position-5' title='4 записи' style='font-size: 9.5730337078652pt;'>crypto api</a>
<a href='https://kaimi.io/tag/dll/' class='tag-link-77 tag-link-position-6' title='11 записей' style='font-size: 15.550561797753pt;'>dll</a>
<a href='https://kaimi.io/tag/gui/' class='tag-link-54 tag-link-position-7' title='3 записи' style='font-size: 8pt;'>gui</a>
<a href='https://kaimi.io/tag/http/' class='tag-link-79 tag-link-position-8' title='4 записи' style='font-size: 9.5730337078652pt;'>http</a>
<a href='https://kaimi.io/tag/inject/' class='tag-link-194 tag-link-position-9' title='7 записей' style='font-size: 12.719101123596pt;'>inject</a>
<a href='https://kaimi.io/tag/javascript/' class='tag-link-105 tag-link-position-10' title='6 записей' style='font-size: 11.932584269663pt;'>JavaScript</a>
<a href='https://kaimi.io/tag/kernel/' class='tag-link-284 tag-link-position-11' title='4 записи' style='font-size: 9.5730337078652pt;'>kernel</a>
<a href='https://kaimi.io/tag/lastfm/' class='tag-link-53 tag-link-position-12' title='7 записей' style='font-size: 12.719101123596pt;'>last.fm</a>
<a href='https://kaimi.io/tag/masm32/' class='tag-link-50 tag-link-position-13' title='17 записей' style='font-size: 18.38202247191pt;'>masm32</a>
<a href='https://kaimi.io/tag/packer/' class='tag-link-366 tag-link-position-14' title='12 записей' style='font-size: 16.022471910112pt;'>packer</a>
<a href='https://kaimi.io/tag/pe/' class='tag-link-215 tag-link-position-15' title='11 записей' style='font-size: 15.550561797753pt;'>pe</a>
<a href='https://kaimi.io/tag/perl/' class='tag-link-562 tag-link-position-16' title='30 записей' style='font-size: 22pt;'>Perl</a>
<a href='https://kaimi.io/tag/php/' class='tag-link-564 tag-link-position-17' title='20 записей' style='font-size: 19.325842696629pt;'>PHP</a>
<a href='https://kaimi.io/tag/plugin/' class='tag-link-75 tag-link-position-18' title='5 записей' style='font-size: 10.831460674157pt;'>plugin</a>
<a href='https://kaimi.io/tag/portable-executable/' class='tag-link-220 tag-link-position-19' title='17 записей' style='font-size: 18.38202247191pt;'>Portable Executable</a>
<a href='https://kaimi.io/tag/proxy/' class='tag-link-129 tag-link-position-20' title='5 записей' style='font-size: 10.831460674157pt;'>proxy</a>
<a href='https://kaimi.io/tag/quest/' class='tag-link-248 tag-link-position-21' title='10 записей' style='font-size: 14.921348314607pt;'>quest</a>
<a href='https://kaimi.io/tag/splicing/' class='tag-link-202 tag-link-position-22' title='5 записей' style='font-size: 10.831460674157pt;'>splicing</a>
<a href='https://kaimi.io/tag/ssh/' class='tag-link-110 tag-link-position-23' title='3 записи' style='font-size: 8pt;'>ssh</a>
<a href='https://kaimi.io/tag/tk/' class='tag-link-52 tag-link-position-24' title='4 записи' style='font-size: 9.5730337078652pt;'>tk</a>
<a href='https://kaimi.io/tag/vkontakte/' class='tag-link-31 tag-link-position-25' title='14 записей' style='font-size: 17.123595505618pt;'>vkontakte</a>
<a href='https://kaimi.io/tag/webmoney/' class='tag-link-176 tag-link-position-26' title='4 записи' style='font-size: 9.5730337078652pt;'>webmoney</a>
<a href='https://kaimi.io/tag/win32-api/' class='tag-link-51 tag-link-position-27' title='12 записей' style='font-size: 16.022471910112pt;'>win32 api</a>
<a href='https://kaimi.io/tag/winapi/' class='tag-link-237 tag-link-position-28' title='9 записей' style='font-size: 14.292134831461pt;'>winapi</a>
<a href='https://kaimi.io/tag/windows-2/' class='tag-link-231 tag-link-position-29' title='10 записей' style='font-size: 14.921348314607pt;'>windows</a>
<a href='https://kaimi.io/tag/%d1%81%d0%be%d1%86%d0%b8%d0%b0%d0%bb%d1%8c%d0%bd%d1%8b%d0%b5-%d1%81%d0%b5%d1%82%d0%b8/' class='tag-link-563 tag-link-position-30' title='3 записи' style='font-size: 8pt;'>Социальные сети</a>
<a href='https://kaimi.io/tag/%d0%b0%d0%bd%d1%82%d0%b8%d0%ba%d0%b0%d0%bf%d1%87%d0%b0/' class='tag-link-55 tag-link-position-31' title='6 записей' style='font-size: 11.932584269663pt;'>антикапча</a>
<a href='https://kaimi.io/tag/%d0%b0%d1%81%d1%81%d0%b5%d0%bc%d0%b1%d0%bb%d0%b5%d1%80/' class='tag-link-49 tag-link-position-32' title='9 записей' style='font-size: 14.292134831461pt;'>ассемблер</a>
<a href='https://kaimi.io/tag/%d0%b1%d1%80%d1%83%d1%82%d1%84%d0%be%d1%80%d1%81/' class='tag-link-16 tag-link-position-33' title='5 записей' style='font-size: 10.831460674157pt;'>брутфорс</a>
<a href='https://kaimi.io/tag/%d0%b2%d0%ba%d0%be%d0%bd%d1%82%d0%b0%d0%ba%d1%82%d0%b5/' class='tag-link-30 tag-link-position-34' title='18 записей' style='font-size: 18.696629213483pt;'>вконтакте</a>
<a href='https://kaimi.io/tag/%d0%ba%d0%b0%d0%bf%d1%87%d0%b0/' class='tag-link-114 tag-link-position-35' title='3 записи' style='font-size: 8pt;'>капча</a>
<a href='https://kaimi.io/tag/%d0%ba%d0%b2%d0%b5%d1%81%d1%82/' class='tag-link-247 tag-link-position-36' title='11 записей' style='font-size: 15.550561797753pt;'>квест</a>
<a href='https://kaimi.io/tag/%d0%be%d0%b1%d1%84%d1%83%d1%81%d0%ba%d0%b0%d1%86%d0%b8%d1%8f/' class='tag-link-38 tag-link-position-37' title='5 записей' style='font-size: 10.831460674157pt;'>обфускация</a>
<a href='https://kaimi.io/tag/%d0%bf%d0%b0%d1%80%d1%81%d0%b5%d1%80/' class='tag-link-13 tag-link-position-38' title='3 записи' style='font-size: 8pt;'>парсер</a>
<a href='https://kaimi.io/tag/%d0%bf%d0%bb%d0%b0%d0%b3%d0%b8%d0%bd/' class='tag-link-74 tag-link-position-39' title='4 записи' style='font-size: 9.5730337078652pt;'>плагин</a>
<a href='https://kaimi.io/tag/%d1%80%d0%b5%d0%b2%d0%b5%d1%80%d1%81%d0%b8%d0%bd%d0%b3/' class='tag-link-81 tag-link-position-40' title='3 записи' style='font-size: 8pt;'>реверсинг</a>
<a href='https://kaimi.io/tag/%d1%81%d0%ba%d1%80%d0%b8%d0%bf%d1%82-%d1%80%d0%b0%d1%81%d1%81%d1%8b%d0%bb%d0%ba%d0%b8/' class='tag-link-83 tag-link-position-41' title='3 записи' style='font-size: 8pt;'>скрипт рассылки</a>
<a href='https://kaimi.io/tag/%d1%81%d0%be%d0%ba%d0%b5%d1%82%d1%8b/' class='tag-link-37 tag-link-position-42' title='3 записи' style='font-size: 8pt;'>сокеты</a>
<a href='https://kaimi.io/tag/%d1%81%d0%bf%d0%bb%d0%b0%d0%b9%d1%81%d0%b8%d0%bd%d0%b3/' class='tag-link-203 tag-link-position-43' title='5 записей' style='font-size: 10.831460674157pt;'>сплайсинг</a>
<a href='https://kaimi.io/tag/%d1%82%d1%80%d0%b0%d1%84%d0%b8%d0%ba/' class='tag-link-89 tag-link-position-44' title='3 записи' style='font-size: 8pt;'>трафик</a>
<a href='https://kaimi.io/tag/%d1%83%d0%bf%d0%b0%d0%ba%d0%be%d0%b2%d1%89%d0%b8%d0%ba/' class='tag-link-365 tag-link-position-45' title='12 записей' style='font-size: 16.022471910112pt;'>упаковщик</a></div>
</li>
<li id="linkcat-96" class="widget widget_links"><h2 class="widgettitle">Ссылки</h2>

    <ul class='xoxo blogroll'>
<li><a href="http://blog.rebz.net/" target="_blank">Rebz&#039;s blog</a></li>
<li><a href="http://mrthe.name/" target="_blank">Блог mr.The</a></li>

    </ul>
</li>

    </ul>
    <br />
</div>
<div class="endfloat">&nbsp;</div>
</div>

<div id="footer">
    <script type='text/javascript'>
/* <![CDATA[ */
var pollsL10n = {"ajax_url":"https:\/\/kaimi.io\/wp-admin\/admin-ajax.php","text_wait":"\u0412\u0430\u0448 \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0438\u0439 \u0437\u0430\u043f\u0440\u043e\u0441 \u0435\u0449\u0435 \u043e\u0431\u0440\u0430\u0431\u0430\u0442\u044b\u0432\u0430\u0435\u0442\u0441\u044f. \u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430 \u043f\u043e\u0434\u043e\u0436\u0434\u0438\u0442\u0435 ...","text_valid":"\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430 \u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u043e \u0432\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u043e\u0442\u0432\u0435\u0442.","text_multiple":"\u041c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e \u0434\u043e\u043f\u0443\u0441\u0442\u0438\u043c\u043e\u0435 \u0447\u0438\u0441\u043b\u043e \u0432\u0430\u0440\u0438\u0430\u043d\u0442\u043e\u0432:","show_loading":"0","show_fading":"0"};
/* ]]> */
</script>
<script type='text/javascript' src='https://kaimi.io/wp-content/plugins/wp-polls/polls-js.js?ver=2.73.1'></script>
<script type='text/javascript' src='https://kaimi.io/wp-includes/js/wp-embed.min.js?ver=4.6.1'></script>
    <p>
        <center>Использование материалов на других ресурсах разрешено только с указанием активной гиперссылки на kaimi.io</center>
<span id="7ecd33c2f49aaa63357450844bbc1fcb"></span>
